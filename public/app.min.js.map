{"version":3,"file":"app.min.js","sources":["../src/banner.ts","../src/utils.ts","../src/display.ts","../src/controls.ts","../src/maths.ts","../src/collision.ts","../src/entityType.ts","../src/worldMap.ts","../src/levels.ts","../src/gameState.ts","../src/graphic.ts","../src/assets.ts","../src/sound.ts","../src/entity.ts","../src/index.ts"],"sourcesContent":["const bannerQueue: Array<{ text: string, size: number }> = [];\nconst topBannerQueue: Array<{ text: string, size: number }> = [];\n\nexport function addBanner(text: string, size: number) {\n  if (currentBanner === text) {\n    return;\n  }\n  for (const banner of bannerQueue) {\n    if (text === banner.text) {\n      return;\n    }\n  }\n  bannerQueue.push({ text, size });\n}\n\nexport function addTopBanner(text: string, size: number) {\n  if (currentTopBanner === text) {\n    return;\n  }\n  for (const banner of topBannerQueue) {\n    if (text === banner.text) {\n      return;\n    }\n  }\n  topBannerQueue.push({ text, size });\n}\n\nlet currentTimer = 0;\nlet currentBanner: string = '';\nlet currentSize = 20;\nconst MAX_TIME = 3;\n\nlet currentTopTimer = 0;\nlet currentTopBanner: string = '';\nlet currentTopSize = 80;\nconst MAX_TOP_TIME = 3;\n\nexport function drawBanner(context: CanvasRenderingContext2D, dT: number) {\n  if (currentTimer <= 0 && bannerQueue.length > 0) {\n    currentTimer = MAX_TIME;\n    const details = bannerQueue.shift()!;\n    currentBanner = details.text;\n    currentSize = details.size;\n  }\n\n  if (currentTimer > 0) {\n    currentTimer -= dT;\n  } else {\n    currentBanner = '';\n    return;\n  }\n\n  context.save();\n  if (currentTimer > 2.5) {\n    context.globalAlpha = 1 - ((currentTimer - 2.5) * 2);\n  }\n  if (currentTimer < 0.5) {\n    context.globalAlpha = Math.max(0, currentTimer * 2);\n  }\n  context.font = `${currentSize}px \"Bungee\", Arial, sans-serif`;\n  context.textBaseline = 'middle';\n  context.fillStyle = 'white';\n  context.strokeStyle = 'black';\n  context.lineWidth = Math.max(1, currentSize / 20);\n  context.shadowOffsetX = Math.max(1, currentSize / 8);\n  context.shadowOffsetY = Math.max(1, currentSize / 8);\n\n  const width = context.measureText(currentBanner).width;\n\n  context.fillText(currentBanner, context.canvas.width / 4 - width / 2, context.canvas.height / 4 + 100);\n  context.strokeText(currentBanner, context.canvas.width / 4 - width / 2, context.canvas.height / 4 + 100);\n  context.restore();\n}\n\nexport function drawTopBanner(context: CanvasRenderingContext2D, dT: number) {\n  if (currentTopTimer <= 0 && topBannerQueue.length > 0) {\n    currentTopTimer = MAX_TOP_TIME;\n    const details = topBannerQueue.shift()!;\n    currentTopBanner = details.text;\n    currentTopSize = details.size;\n  }\n\n  if (currentTopTimer > 0) {\n    currentTopTimer -= dT;\n  } else {\n    currentTopBanner = '';\n    return;\n  }\n\n  context.save();\n  if (currentTopTimer > 2.5) {\n    context.globalAlpha = 1 - ((currentTopTimer - 2.5) * 2);\n  }\n  if (currentTopTimer < 0.5) {\n    context.globalAlpha = Math.max(0, currentTopTimer * 2);\n  }\n  context.font = `${currentTopSize}px \"Bungee\", Arial, sans-serif`;\n  context.textBaseline = 'middle';\n  context.fillStyle = 'white';\n  context.strokeStyle = 'black';\n  context.lineWidth = Math.max(1, currentTopSize / 20);\n  context.shadowOffsetX = Math.max(1, currentTopSize / 8);\n  context.shadowOffsetY = Math.max(1, currentTopSize / 8);\n\n  const width = context.measureText(currentTopBanner).width;\n\n  context.fillText(currentTopBanner, context.canvas.width / 4 - width / 2, context.canvas.height / 4 - 100);\n  context.strokeText(currentTopBanner, context.canvas.width / 4 - width / 2, context.canvas.height / 4 - 100);\n  context.restore();\n}\n","export function err(): never {\n  throw new Error('Something went wrong!');\n}\n\n/**\n * inputs and outputs are [0, 1], except h.\n */\nexport function hsvToRgb(h: number, s: number, v: number) {\n  if (s === 0) {\n    return [v, v, v];\n  }\n  if (h >= 360) {\n    h = 0;\n  }\n  h /= 60;\n\n  const i = Math.floor(h);\n  const ff = h - i;\n  const p = v * (1 - s);\n  const q = v * (1 - (s * ff));\n  const t = v * (1 - (s * (1 - ff)));\n\n  switch (i) {\n    case 0:\n      return [v, t, p];\n    case 1:\n      return [q, v, p];\n    case 2:\n      return [p, v, t];\n    case 3:\n      return [p, q, v];\n    case 4:\n      return [t, p, v];\n    case 5:\n    default:\n      return [v, p, q];\n  }\n}\n\nexport function clamp(value: number, min: number, max: number): number {\n  return Math.max(min, Math.min(max, value));\n}\n","import { err } from './utils';\n\nexport const canvas = document.getElementById('canvas')! as HTMLCanvasElement;\nexport const context = canvas.getContext('2d') || err();\n\ncanvas.width = 1920;\ncanvas.height = 1080;\nconst targetAspect = canvas.width / canvas.height;\n// context.imageSmoothingEnabled = false;\ncontext.scale(2, 2);\n\nfunction resize() {\n  const aspect = window.innerWidth / window.innerHeight;\n  if (aspect > targetAspect) {\n    canvas.style.height = window.innerHeight + 'px';\n    canvas.style.width = (window.innerWidth * targetAspect / aspect) + 'px';\n  } else {\n    canvas.style.width = window.innerWidth + 'px';\n    canvas.style.height = (window.innerHeight * aspect / targetAspect) + 'px';\n  }\n}\n\nresize();\nwindow.addEventListener('resize', resize);\nwindow.addEventListener('click', () => {\n  canvas.webkitRequestFullscreen();\n});\n\ndocument.body.appendChild(canvas);\n","import { canvas } from './display';\n\nexport enum Key {\n  Space = 32,\n\n  Left = 37,\n  Up = 38,\n  Right = 39,\n  Down = 40,\n\n  One = 49,\n  Two = 50,\n\n  A = 65,\n  D = 68,\n  P = 80,\n  S = 83,\n  W = 87,\n}\n\nconst keystate: { [key: number]: boolean } = {};\n\nconst controls = {\n  isPressed(key: number) {\n    return keystate[key];\n  },\n};\n\nfunction keydown(e: KeyboardEvent) {\n  keystate[e.keyCode] = true;\n  if (!document.webkitFullscreenElement) {\n    canvas.webkitRequestFullscreen();\n  }\n}\n\nfunction keyup(e: KeyboardEvent) {\n  keystate[e.keyCode] = false;\n}\n\ndocument.addEventListener('keydown', keydown);\ndocument.addEventListener('keyup', keyup);\n\nexport default controls;\n","export type V2 = number[] | Float32Array | Float64Array;\n\nexport const v2 = {\n  create(x = 0, y = 0): V2 {\n    return [x, y];\n  },\n\n  set(result: V2, x = 0, y = 0) {\n    result[0] = x;\n    result[1] = y;\n  },\n\n  clone(result: V2, a: V2) {\n    result[0] = a[0];\n    result[1] = a[1];\n  },\n\n  isZero(a: V2): boolean {\n    return a[0] === 0 && a[1] === 0;\n  },\n\n  normalise(result: V2, a: V2) {\n    if (!v2.isZero(a)) {\n      const length = v2.length(a);\n      result[0] = a[0] / length;\n      result[1] = a[1] / length;\n    }\n  },\n\n  lengthSquared(a: V2): number {\n    return a[0] ** 2 + a[1] ** 2;\n  },\n\n  length(a: V2): number {\n    return Math.sqrt(v2.lengthSquared(a));\n  },\n\n  distanceSquared(a: V2, b: V2) {\n    return (a[0] - b[0]) ** 2 + (a[1] - b[1]) ** 2;\n  },\n\n  distance(a: V2, b: V2) {\n    return Math.sqrt(this.distanceSquared(a, b));\n  },\n\n  angle(a: V2): number {\n    return Math.atan2(a[1], a[0]);\n  },\n\n  add(result: V2, a: V2, b: V2) {\n    result[0] = a[0] + b[0];\n    result[1] = a[1] + b[1];\n  },\n\n  sub(result: V2, a: V2, b: V2) {\n    result[0] = a[0] - b[0];\n    result[1] = a[1] - b[1];\n  },\n\n  mul(result: V2, a: V2, scalar: number) {\n    result[0] = a[0] * scalar;\n    result[1] = a[1] * scalar;\n  },\n\n  rotate(result: V2, a: V2, angle: number) {\n    const s = Math.sin(angle);\n    const c = Math.cos(angle);\n    const x = a[0];\n    const y = a[1];\n\n    result[0] = c * x - s * y;\n    result[1] = s * x + c * y;\n  },\n\n  invert(result: V2, a: V2) {\n    result[0] = -a[0];\n    result[1] = -a[1];\n  },\n\n  dot(a: V2, b: V2): number {\n    return a[0] * b[0] + a[1] * b[1];\n  },\n};\n","// GJK/Mikowski collision\nimport { v2, V2 } from './maths';\n\nexport type SupportFunction = (direction: V2) => V2;\n\nconst ao = v2.create();\nconst ab = v2.create();\nconst ac = v2.create();\n\nfunction update(simplex: V2[], direction: V2): boolean {\n  const last: V2 = simplex[simplex.length - 1];\n  const n = simplex.length;\n  if (n === 1) {\n    direction[0] = -last[0];\n    direction[1] = -last[1];\n    return false;\n  }\n  v2.invert(ao, last);\n  v2.sub(ab, simplex[0], last);\n\n  if (n === 2) {\n    direction[0] = -ab[1];\n    direction[1] = ab[0];\n\n    if (v2.dot(direction, ao) < 0) {\n      direction[0] = -direction[0];\n      direction[1] = -direction[1];\n    }\n\n    return false;\n  }\n\n  if (n === 3) {\n    direction[0] = -ab[1];\n    direction[1] = ab[0];\n\n    if (v2.dot(direction, simplex[1]) > 0) {\n      direction[0] = -direction[0];\n      direction[1] = -direction[1];\n    }\n\n    if (v2.dot(direction, ao) > 0) {\n      simplex[1] = simplex[2];\n      const old = simplex.pop()!;\n\n      return false;\n    }\n\n    v2.sub(ac, simplex[1], last);\n    direction[0] = -ac[1];\n    direction[1] = ac[0];\n\n    if (v2.dot(direction, simplex[0]) > 0) {\n      direction[0] = -direction[0];\n      direction[1] = -direction[1];\n    }\n\n    if (v2.dot(direction, ao) > 0) {\n      simplex.shift();\n      return false;\n    }\n\n    return true;\n  }\n  return false;\n}\n\nconst inverseDirection = v2.create();\n\nexport function combineSupport(support1: SupportFunction, support2: SupportFunction): SupportFunction {\n  // TODO: cache these functions\n  return (direction: V2): V2 => {\n    v2.invert(inverseDirection, direction);\n    const s1 = support1(direction);\n    const s2 = support2(inverseDirection);\n    v2.sub(s1, s1, s2);\n    return s1;\n  };\n}\n\nexport function intersect(support1: SupportFunction, support2: SupportFunction): boolean {\n  return intersection(combineSupport(support1, support2));\n}\n\nfunction intersection(support: SupportFunction): boolean {\n  const simplex: V2[] = [];\n  const direction = v2.create(1, 0);\n  while (true) {\n    const a = support(direction);\n    if (v2.dot(a, direction) < 0) {\n      return false;\n    }\n\n    simplex.push(a);\n\n    if (update(simplex, direction)) {\n      return true;\n    }\n  }\n}\n","export enum EntityType {\n  Player,\n  Heart,\n  Mcguffin,\n  Goblin,\n  GoblinArcher,\n  Projectile,\n  Exit,\n  Spikes,\n  Grenade,\n  Explosion,\n  GrenadePickup,\n}\n","import { intersect } from './collision';\nimport Entity from './entity';\nimport { V2, v2 } from './maths';\nimport { IObjectLayerData, ITileData, ITileLayerData } from './tileData';\nimport { hsvToRgb } from './utils';\n\nconst TILE_SIZE = 32;\n\nconst tileColors: Array<{ light: string, dark: string }> = [];\n\nconst s = 1;\nconst highV = 0.8;\nconst lowV = 0.5;\nfor (let i = 0; i < 16; i++) {\n  const h = (360 / 16) * i;\n  const [r, g, b] = hsvToRgb(h, s, highV);\n  const [dr, dg, db] = hsvToRgb(h, s, lowV);\n  tileColors[i] = {\n    dark: `rgb(${Math.floor(dr * 256)}, ${Math.floor(dg * 256)}, ${Math.floor(db * 256)}`,\n    light: `rgb(${Math.floor(r * 256)}, ${Math.floor(g * 256)}, ${Math.floor(b * 256)}`,\n  };\n}\n\nexport default class WorldMap {\n  objectLayers: IObjectLayerData[] = [];\n  width: number;\n  height: number;\n\n  private data: ITileData;\n  private tileLayers: ITileLayerData[] = [];\n\n  constructor(data: ITileData) {\n    this.data = data;\n\n    for (const layer of data.layers) {\n      if (layer.type === 'tilelayer') {\n        const tileLayer = layer as ITileLayerData;\n        this.tileLayers.push(tileLayer);\n        this.width = tileLayer.width;\n        this.height = tileLayer.height;\n        for (let i = 0; i < tileLayer.data.length; i++) {\n          if (tileLayer.data[i] !== 0) {\n            tileLayer.data[i] = Math.floor(Math.random() * 15) + 1;\n          }\n        }\n      } else if (layer.type === 'objectgroup') {\n        const objectLayer = layer as IObjectLayerData;\n        this.objectLayers.push(objectLayer);\n      }\n    }\n  }\n\n  getTileIndex(x: number, y: number) {\n    return ((this.height - y - 1) * this.width) + x;\n  }\n\n  translateObjectPosition(x: number, y: number): V2 {\n    return [x, (this.height * TILE_SIZE) + 31 - y];\n  }\n\n  willCollide(entity: Entity, tileX: number, tileY: number) {\n    const entitySupport = entity.collisionSupport.bind(entity);\n    const tileSupport = (direction: V2) => {\n      const result = v2.create(tileX * TILE_SIZE, tileY * TILE_SIZE);\n      if (direction[0] > 0) {\n        result[0] += TILE_SIZE;\n      }\n      if (direction[1] > 0) {\n        result[1] += TILE_SIZE;\n      }\n      return result;\n    };\n    return intersect(entitySupport, tileSupport);\n  }\n\n  findCollision(entity: Entity): {time: number, normal: V2} {\n    const minX = Math.min(entity.dP[0], 0) + entity.pos[0] - entity.radius;\n    const minY = Math.min(entity.dP[1], 0) + entity.pos[1] - entity.radius;\n    const maxX = Math.max(entity.dP[0], 0) + entity.pos[0] + entity.radius;\n    const maxY = Math.max(entity.dP[1], 0) + entity.pos[1] + entity.radius;\n\n    const minTileX = Math.max(0, Math.floor(minX / TILE_SIZE));\n    const minTileY = Math.max(0, Math.floor(minY / TILE_SIZE));\n    const maxTileX = Math.floor(maxX / TILE_SIZE);\n    const maxTileY = Math.floor(maxY / TILE_SIZE);\n\n    const currentTileX = Math.floor(entity.pos[0] / TILE_SIZE);\n    const currentTileY = Math.floor(entity.pos[1] / TILE_SIZE);\n\n    const normal = [0, 0];\n    let bestTime = 1;\n\n    for (let y = minTileY; y <= maxTileY && y < this.height; y++) {\n      for (let x = minTileX; x <= maxTileX && x < this.width; x++) {\n        if (this.tileLayers[0].data[this.getTileIndex(x, y)] !== 0) {\n          if (this.willCollide(entity, x, y)) {\n            const tileNormal = [0, 0];\n            let tileTime = 1;\n            const tileLeft = x * TILE_SIZE;\n            const tileRight = tileLeft + TILE_SIZE;\n            const tileBottom = y * TILE_SIZE;\n            const tileTop = tileBottom + TILE_SIZE;\n\n            if (tileTop < entity.pos[1]) {\n              tileNormal[1] = 1;\n              if (entity.dP[1] < 0) {\n                const distance = ((y + 1) * TILE_SIZE) - (entity.pos[1] - entity.radius);\n                tileTime = Math.min(distance / entity.dP[1], tileTime);\n              }\n            } else if (tileBottom > entity.pos[1]) {\n              tileNormal[1] = -1;\n              if (entity.dP[1] > 0) {\n                const distance = (y * TILE_SIZE) - (entity.pos[1] + entity.radius);\n                tileTime = Math.min(distance / entity.dP[1], tileTime);\n              }\n            } else if (tileRight < entity.pos[0]) {\n              tileNormal[0] = 1;\n              if (entity.dP[0] < 0) {\n                const distance = ((x + 1) * TILE_SIZE) - (entity.pos[0] - entity.radius);\n                tileTime = Math.min(distance / entity.dP[0], tileTime);\n              }\n            } else if (tileLeft > entity.pos[0]) {\n              tileNormal[0] = -1;\n              if (entity.dP[0] > 0) {\n                const distance = (x * TILE_SIZE) - (entity.pos[0] + entity.radius);\n                tileTime = Math.min(distance / entity.dP[0], tileTime);\n              }\n            }\n\n            // TODO: Collision system crappiness! Can bump off the top corner of\n            // a tile even though you can only access the top.\n\n            if (tileTime >= 0 && tileTime <= bestTime) {\n              bestTime = tileTime;\n              v2.clone(normal, tileNormal);\n            }\n          }\n        }\n      }\n    }\n    v2.normalise(normal, normal);\n    return { time: bestTime, normal };\n  }\n\n  /**\n   * The context should be pre-transformed to the correct viewport and orientation\n   */\n  draw(context: CanvasRenderingContext2D) {\n    for (let y = 0; y < this.height; y++) {\n      for (let x = 0; x < this.width; x++) {\n        const tile = this.tileLayers[0].data[this.getTileIndex(x, y)];\n        if (tile !== 0) {\n          context.fillStyle = tileColors[tile].light;\n          context.fillRect((x * TILE_SIZE), (y * TILE_SIZE), TILE_SIZE, TILE_SIZE);\n          context.fillStyle = tileColors[tile].dark;\n          context.beginPath();\n          context.moveTo((x * TILE_SIZE), (y * TILE_SIZE));\n          context.lineTo(((1 + x) * TILE_SIZE), (y * TILE_SIZE));\n          context.lineTo(((1 + x) * TILE_SIZE), ((1 + y) * TILE_SIZE));\n          context.closePath();\n          context.fill();\n          // context.strokeStyle = 'white';\n          // context.strokeRect(x * TILE_SIZE, y * TILE_SIZE, TILE_SIZE, TILE_SIZE);\n        }\n      }\n    }\n  }\n}\n","import Entity from './entity';\nimport { EntityType } from './entityType';\nimport { V2, v2 } from './maths';\nimport WorldMap from './worldMap';\n\nconst levelFiles = ['level1.json', 'level2.json', 'level3.json'];\nconst levels: Level[] = [];\n\nexport const levelsLoaded = Promise.all(levelFiles.map(loadLevel));\n\nexport function getLevel(id: number) {\n  return levels[id % levels.length];\n}\n\nasync function loadLevel(name: string, index: number) {\n  const response = await fetch(`levels/${name}`);\n  const data = await response.json();\n  const map = new WorldMap(data);\n  const level = new Level(map);\n  levels[index] = level;\n}\n\n// Stupidness. Tiled shows the ids as one less than actually found in the file\nenum MapObjectType {\n  Spawn = 65,\n  Exit = 66,\n  Creature1 = 97,\n  Creature2 = 98,\n  Creature3 = 99,\n  GrenadePickup = 100,\n  Mcguffin = 129,\n  Heart = 130,\n  Spikes = 131,\n}\n\nconst ObjectToEntityMap: {[key: number]: EntityType} = {\n  [MapObjectType.Exit]: EntityType.Exit,\n  [MapObjectType.Creature1]: EntityType.Goblin,\n  [MapObjectType.Creature2]: EntityType.GoblinArcher,\n  [MapObjectType.Heart]: EntityType.Heart,\n  [MapObjectType.Mcguffin]: EntityType.Mcguffin,\n  [MapObjectType.Spikes]: EntityType.Spikes,\n  [MapObjectType.GrenadePickup]: EntityType.GrenadePickup,\n};\n\nexport class Level {\n  spawn: V2 = v2.create();\n  mcguffinCount = 0;\n\n  constructor(public map: WorldMap) {\n    // TODO: Set spawn from map here\n    for (const layer of map.objectLayers) {\n      for (const obj of layer.objects) {\n        const type = obj.gid as MapObjectType;\n        if (type === MapObjectType.Spawn) {\n          v2.clone(this.spawn, map.translateObjectPosition(obj.x, obj.y));\n        }\n        if (type === MapObjectType.Mcguffin) {\n          this.mcguffinCount++;\n        }\n      }\n    }\n  }\n\n  getEntities(): Entity[] {\n    const result: Entity[] = [];\n\n    for (const layer of this.map.objectLayers) {\n      for (const obj of layer.objects) {\n        const type = obj.gid as MapObjectType;\n        if (ObjectToEntityMap[type]) {\n          result.push(new Entity(ObjectToEntityMap[type], this.map.translateObjectPosition(obj.x, obj.y)));\n        }\n      }\n    }\n    return result;\n  }\n}\n","import { addBanner, addTopBanner } from './banner';\nimport Entity from './entity';\nimport { EntityType } from './entityType';\nimport { getLevel, Level } from './levels';\nimport { v2 } from './maths';\n\nexport enum WeaponType {\n  Gun,\n  Grenade,\n}\n\nexport const entities: Set<Entity> = new Set();\nexport let player: Entity;\nexport let level: Level;\nexport let paused = false;\nexport const weaponsAvailable: WeaponType[] = [WeaponType.Gun];\nexport const debuffs = {\n  doubleDamage: false,\n  fastMonsters: false,\n  noHeal: false,\n  slowRegen: false,\n  undead: false,\n};\n\nlet currentLevelId = 0;\n\nexport function reset() {\n  player = new Entity(EntityType.Player, [20, 20]);\n  changeLevel(currentLevelId);\n}\n\nexport function togglePause() {\n  paused = !paused;\n}\n\nexport function nextLevel() {\n  changeLevel(currentLevelId + 1);\n}\n\nexport function addDebuff() {\n  const available: string[] = [];\n\n  if (!debuffs.doubleDamage) {\n    available.push('doubleDamage');\n  }\n  if (!debuffs.noHeal) {\n    available.push('noHeal');\n  }\n  if (!debuffs.fastMonsters) {\n    available.push('fastMonsters');\n  }\n  if (!debuffs.slowRegen) {\n    available.push('slowRegen');\n  }\n  if (!debuffs.undead) {\n    available.push('undead');\n  }\n\n  const choice = Math.floor(Math.random() * available.length);\n\n  switch (available[choice]) {\n    case 'doubleDamage': {\n      debuffs.doubleDamage = true;\n      addBanner('Curse: Enemy Damage X2', 50);\n      break;\n    }\n    case 'fastMonsters': {\n      debuffs.fastMonsters = true;\n      addBanner('Curse: Fast enemies', 50);\n      break;\n    }\n    case 'noHeal': {\n      debuffs.noHeal = true;\n      addBanner('Curse: No healing', 50);\n      break;\n    }\n    case 'slowRegen': {\n      debuffs.slowRegen = true;\n      addBanner('Curse: Ammo regen 50%', 50);\n      break;\n    }\n    case 'undead': {\n      debuffs.undead = true;\n      addBanner(`Curse: Enemies don't stay dead`, 45);\n      break;\n    }\n  }\n}\n\nexport function changeLevel(id: number) {\n  addTopBanner(`Level ${id + 1}`, 80);\n  if (id === 0) {\n    addBanner('A,  D to move', 30);\n    addBanner('Space to jump', 30);\n    addBanner('Arrow keys shoot', 30);\n    addBanner('Collect cursed lava lamps to open the door', 30);\n    addBanner('Lava lamp curses last the rest of the level', 30);\n    addBanner('(or until you die!)', 30);\n  }\n\n  debuffs.doubleDamage = false;\n  debuffs.fastMonsters = false;\n  debuffs.noHeal = false;\n  debuffs.slowRegen = false;\n  debuffs.undead = false;\n\n  currentLevelId = id;\n  level = getLevel(id);\n  entities.clear();\n  v2.clone(player.pos, level.spawn);\n  player.mcguffins = [];\n  const levelEntities = level.getEntities();\n  entities.add(player);\n  for (const entity of levelEntities) {\n    entities.add(entity);\n  }\n}\n","import { Facing } from './entity';\nimport { V2 } from './maths';\nimport { err } from './utils';\n\nconst spritesheet: HTMLImageElement = new Image();\n\nexport const spritesLoaded = new Promise((resolve, reject) => {\n  spritesheet.onload = resolve;\n  spritesheet.onerror = reject;\n});\n\nspritesheet.src = 'assets/sprites.png';\n\nfunction getCanvas(width: number, height: number): [HTMLCanvasElement, CanvasRenderingContext2D] {\n  const canvas = document.createElement('canvas');\n\n  canvas.width = width;\n  canvas.height = height;\n\n  const context = canvas.getContext('2d') || err();\n\n  return [canvas, context];\n}\n\nfunction makeGoblinGraphic(color: string): HTMLCanvasElement {\n  const [canvas, context] = getCanvas(20, 20);\n\n  context.translate(10, 10);\n  context.fillStyle = color;\n  context.strokeStyle = 'white';\n  context.beginPath();\n  context.arc(0, 0, 8, 0, Math.PI * 2, false);\n  context.fill();\n  context.stroke();\n  context.fillRect(8, -4, 2, 8);\n\n  return canvas;\n}\n\nfunction makePlayerGraphic(): HTMLCanvasElement {\n  const [canvas, context] = getCanvas(16, 16);\n\n  context.fillStyle = 'purple';\n  context.strokeStyle = 'white';\n  context.fillRect(0, 0, 16, 16);\n  context.strokeRect(0, 0, 16, 16);\n\n  return canvas;\n}\n\nfunction makeFallbackGraphic() {\n  const [canvas, context] = getCanvas(32, 32);\n\n  context.fillStyle = 'blue';\n  context.fillRect(0, 0, 32, 32);\n\n  context.strokeStyle = 'white';\n  context.beginPath();\n  context.moveTo(0, 0);\n  context.lineTo(31, 31);\n  context.moveTo(0, 31);\n  context.lineTo(31, 0);\n  context.stroke();\n\n  return canvas;\n}\n\nfunction makeProjectileGraphic() {\n  const [canvas, context] = getCanvas(10, 10);\n\n  context.fillStyle = 'yellow';\n  context.strokeStyle = 'black';\n\n  context.beginPath();\n  context.arc(4, 4, 4, 0, Math.PI * 2, false);\n  context.fill();\n  context.stroke();\n\n  return canvas;\n}\n\nfunction makeGrenadeGraphic() {\n  const [canvas, context] = getCanvas(16, 16);\n\n  context.fillStyle = 'black';\n  context.strokeStyle = 'black';\n\n  context.beginPath();\n  context.arc(8, 8, 8, 0, Math.PI * 2, false);\n  context.fill();\n  context.beginPath();\n  context.moveTo(8, 8);\n  context.lineTo(16, 16);\n  context.stroke();\n  context.strokeStyle = 'yellow';\n\n  context.beginPath();\n  context.moveTo(15, 15);\n  context.lineTo(16, 16);\n  context.stroke();\n\n  return canvas;\n}\n\nfunction makeHeartGraphic() {\n  const [canvas, context] = getCanvas(32, 32);\n\n  const tileX = 1;\n  const tileY = 4;\n\n  spritesLoaded.then(() => {\n    context.translate(0, 32);\n    context.scale(1, -1);\n    context.drawImage(spritesheet, tileX * 32, tileY * 32, 32, 32, 0, 0, 32, 32);\n  });\n\n  return canvas;\n}\n\nfunction makeMcguffinGraphic() {\n  const [canvas, context] = getCanvas(32, 32);\n\n  const tileX = 0;\n  const tileY = 4;\n\n  spritesLoaded.then(() => {\n    context.translate(0, 32);\n    context.scale(1, -1);\n    context.drawImage(spritesheet, tileX * 32, tileY * 32, 32, 32, 0, 0, 32, 32);\n  });\n\n  return canvas;\n}\n\nfunction makeExitGraphic() {\n  const [canvas, context] = getCanvas(32, 32);\n\n  const tileX = 1;\n  const tileY = 2;\n\n  spritesLoaded.then(() => {\n    context.translate(0, 32);\n    context.scale(1, -1);\n    context.drawImage(spritesheet, tileX * 32, tileY * 32, 32, 32, 0, 0, 32, 32);\n  });\n\n  return canvas;\n}\n\nfunction makeSpikesGraphic() {\n  const [canvas, context] = getCanvas(32, 32);\n\n  const tileX = 2;\n  const tileY = 4;\n\n  spritesLoaded.then(() => {\n    context.translate(0, 32);\n    context.scale(1, -1);\n    context.drawImage(spritesheet, tileX * 32, tileY * 32, 32, 32, 0, 0, 32, 32);\n  });\n\n  return canvas;\n}\n\nfunction makeGunIconGraphic() {\n  const [canvas, context] = getCanvas(32, 32);\n\n  const tileX = 3;\n  const tileY = 4;\n\n  spritesLoaded.then(() => {\n    // context.translate(0, 32);\n    // context.scale(1, -1);\n    context.drawImage(spritesheet, tileX * 32, tileY * 32, 32, 32, 0, 0, 32, 32);\n  });\n\n  return canvas;\n}\n\nfunction makeBombIconGraphic() {\n  const [canvas, context] = getCanvas(32, 32);\n\n  const tileX = 3;\n  const tileY = 3;\n\n  spritesLoaded.then(() => {\n    // context.translate(0, 32);\n    // context.scale(1, -1);\n    context.drawImage(spritesheet, tileX * 32, tileY * 32, 32, 32, 0, 0, 32, 32);\n  });\n\n  return canvas;\n}\n\nexport const playerGraphic = makePlayerGraphic();\nexport const fallbackGraphic = makeFallbackGraphic();\nexport const goblinGraphic = makeGoblinGraphic('orange');\nexport const goblinArcherGraphic = makeGoblinGraphic('red');\nexport const heartGraphic = makeHeartGraphic();\nexport const mcguffinGraphic = makeMcguffinGraphic();\nexport const projectileGraphic = makeProjectileGraphic();\nexport const exitGraphic = makeExitGraphic();\nexport const spikesGraphic = makeSpikesGraphic();\nexport const grenadeGraphic = makeGrenadeGraphic();\nexport const gunIconGraphic = makeGunIconGraphic();\nexport const bombIconGraphic = makeBombIconGraphic();\n","const images = [\n  'sprites.png',\n];\n\nconst music: string[] = [];\n\nconst other = [\n  'click.wav',\n  'click2.wav',\n  'explosion1.wav',\n  'pop.wav',\n  'squelch1.wav',\n  'urgh.wav',\n  'whoop.wav',\n];\n\ntype Asset = HTMLImageElement | HTMLAudioElement | ArrayBuffer;\n\nconst loaded: Map<string, Asset> = new Map();\n\nfunction makeURL(filename: string): string {\n  return `assets/${filename}`;\n}\n\nlet pending = 0;\n\nexport const assetsLoaded = new Promise((resolve, reject) => {\n  const success = (url: string, object: Asset) => {\n    pending--;\n    loaded.set(url, object);\n    if (pending === 0) {\n      resolve();\n    }\n  };\n\n  const fail = (url: string, err: Error | string) => {\n    pending--;\n    console.log(`Couldn't load ${url}: ${err}`);\n    if (pending === 0) {\n      resolve();\n    }\n  };\n\n  for (const imageURL of images) {\n    pending++;\n    const image = new Image();\n    image.src = makeURL(imageURL);\n    image.onload = () => success(imageURL, image);\n    image.onerror = (e) => fail(imageURL, e.error);\n  }\n\n  for (const musicURL of music) {\n    pending++;\n    const audio = document.createElement('audio');\n    audio.src = makeURL(musicURL);\n    audio.oncanplay = () => success(musicURL, audio);\n    audio.onerror = (e) => fail(musicURL, e.error);\n  }\n\n  for (const url of other) {\n    pending++;\n    fetch(makeURL(url)).then((response) => response.arrayBuffer())\n      .then((buffer) => success(url, buffer))\n      .catch((reason) => fail(url, reason));\n  }\n});\n\n// TODO: Progress meter\n\nexport function getAsset(name: string): Asset | undefined {\n  return loaded.get(name);\n}\n","import {assetsLoaded, getAsset} from './assets';\nimport { clamp } from './utils';\n\nconst soundAssets: string[] = [\n  'click',\n  'click2',\n  'explosion1',\n  'pop',\n  'squelch1',\n  'urgh',\n  'whoop',\n];\n\nconst sounds: Map<string, AudioBuffer> = new Map();\nconst context = new AudioContext();\n\nconst soundGainNode = context.createGain();\nconst musicGainNode = context.createGain();\n\nsoundGainNode.connect(context.destination);\nmusicGainNode.connect(context.destination);\n\nassetsLoaded.then(() => {\n  for (const name of soundAssets) {\n    const data = getAsset(`${name}.wav`) as ArrayBuffer;\n    context.decodeAudioData(data, (buffer) => {\n      sounds.set(name, buffer);\n    });\n  }\n});\n\nclass SoundManager {\n  get musicVolume() {\n    return musicGainNode.gain.value;\n  }\n\n  set musicVolume(value: number) {\n    value = clamp(value, 0, 1);\n    musicGainNode.gain.value = value;\n  }\n\n  get soundVolume() {\n    return soundGainNode.gain.value;\n  }\n\n  set soundVolume(value: number) {\n    value = clamp(value, 0, 1);\n    soundGainNode.gain.value = value;\n  }\n\n  play(name: string) {\n    if (sounds.has(name)) {\n      const source = context.createBufferSource();\n      source.buffer = sounds.get(name)!;\n      source.connect(soundGainNode);\n      source.start();\n    }\n  }\n\n  connectMusic(audio: HTMLAudioElement) {\n    const source = context.createMediaElementSource(audio);\n    source.connect(musicGainNode);\n  }\n}\nexport default new SoundManager();\n","import { addBanner } from './banner';\nimport { intersect } from './collision';\nimport controls, { Key } from './controls';\nimport { EntityType } from './entityType';\nimport {\n  addDebuff, debuffs, entities, level, nextLevel, player, reset, togglePause, weaponsAvailable, WeaponType,\n} from './gameState';\nimport {\n  bombIconGraphic, exitGraphic, fallbackGraphic, goblinArcherGraphic, goblinGraphic,\n  grenadeGraphic, heartGraphic, mcguffinGraphic, playerGraphic, projectileGraphic, spikesGraphic,\n} from './graphic';\nimport { V2, v2 } from './maths';\nimport sound from './sound';\n\nconst g = [0, -980];\nconst EPSILON = 0.00000001;\n\nenum Faction {\n  Foe,\n  Friend,\n  Neither,\n}\n\nexport enum Facing {\n  Left,\n  Right,\n  Up,\n  Down,\n}\n\nenum CollisionResponse {\n  Bounce,\n  Stop,\n  Deflect,\n  TurnAround,\n}\n\nexport default class Entity {\n  pos: V2 = v2.create();\n  dP: V2 = v2.create();\n  v: V2 = v2.create();\n  dV: V2 = v2.create();\n  facing = Facing.Right;\n\n  // flags\n  collidable = true; // Does this entity interact with things in the same space?\n  killable = false;\n  controlled = false;\n  // solid = false; // Solid entities cannot be in the same space as each other\n  limitedLife = false;\n  harmful = false;\n  flying = false;\n  onGround = false;\n  pacer = false;\n  destroyOnUse = false;\n  collectable = false;\n  undead = false;\n  explodes = false;\n  isExplosion = false; // Fairly desperate stuff at this hour\n\n  collisionResponse = CollisionResponse.Deflect;\n  health = 0;\n  maxHealth = 100;\n  speed = 1000;\n  lifespan = 0;\n  damage = 0;\n  faction = Faction.Foe;\n  // TODO: Weapons should be their own thing, not part of entity\n  weaponTimer = 0;\n  weaponRange = 200;\n  radius = 8;\n  target: Entity | null = null;\n  onhit: ((e: Entity) => void) | null;\n  mcguffins: any[] = []; // TODO: Make these better typed\n  cooldown: number = 0; // Generic, used for lots of things\n  ammo = 0;\n  ammoMax = 0;\n  ammoRegen = 1;\n  ammoTimer = 0;\n  weaponType: WeaponType = WeaponType.Gun;\n  explosionTimer = 0;\n\n  graphic = fallbackGraphic;\n\n  constructor(type: EntityType, pos: V2, options: { [key: string]: any } = {}) {\n    v2.clone(this.pos, pos);\n\n    switch (type) {\n      case EntityType.Player: {\n        this.controlled = true;\n        this.killable = true;\n        this.maxHealth = 100;\n        this.graphic = playerGraphic;\n        this.speed = 2000;\n        // this.solid = true;\n        this.faction = Faction.Friend;\n        this.ammoMax = 50;\n        this.ammo = 50;\n        break;\n      }\n\n      case EntityType.GrenadePickup: {\n        this.graphic = bombIconGraphic;\n        this.faction = Faction.Friend;\n        this.radius = 16;\n        this.onhit = (other: Entity) => {\n          weaponsAvailable.push(WeaponType.Grenade);\n          this.die();\n        };\n        break;\n      }\n\n      case EntityType.Goblin: {\n        this.killable = true;\n        this.maxHealth = 20;\n        this.graphic = goblinGraphic;\n        this.speed = 1000;\n        // this.solid = true;\n        this.pacer = true;\n        this.harmful = true;\n        this.damage = 100;\n        this.collisionResponse = CollisionResponse.TurnAround;\n        break;\n      }\n\n      case EntityType.GoblinArcher: {\n        this.killable = true;\n        this.maxHealth = 40;\n        this.graphic = goblinArcherGraphic;\n        this.speed = 1000;\n        // this.solid = true;\n        this.pacer = true;\n        this.harmful = true;\n        this.damage = 100;\n        this.collisionResponse = CollisionResponse.TurnAround;\n        this.target = player;\n        this.ammo = 100;\n        this.ammoMax = 100;\n        this.ammoRegen = 0.1;\n        break;\n      }\n\n      case EntityType.Spikes: {\n        this.graphic = spikesGraphic;\n        this.harmful = true;\n        this.damage = 100;\n        this.flying = true;\n        break;\n      }\n\n      case EntityType.Projectile: {\n        this.graphic = projectileGraphic;\n        this.faction = options.faction || Faction.Foe;\n        this.facing = options.facing || Facing.Left;\n        switch (this.facing) {\n          case Facing.Left: {\n            v2.set(this.v, -1000, 0);\n            break;\n          }\n          case Facing.Right: {\n            v2.set(this.v, 1000, 0);\n            break;\n          }\n          case Facing.Up: {\n            v2.set(this.v, 0, 1000);\n            break;\n          }\n          case Facing.Down: {\n            v2.set(this.v, 0, -1000);\n            break;\n          }\n        }\n        this.radius = 4;\n        this.limitedLife = true;\n        this.lifespan = 2;\n        this.harmful = true;\n        this.damage = 10;\n        this.flying = true;\n        this.destroyOnUse = true;\n        break;\n      }\n\n      case EntityType.Heart: {\n        this.graphic = heartGraphic;\n        this.faction = Faction.Friend;\n        this.radius = 16;\n        this.collectable = true;\n        this.health = 10;\n        break;\n      }\n\n      case EntityType.Grenade: {\n        this.graphic = grenadeGraphic;\n        this.radius = 8;\n        this.faction = options.faction || Faction.Foe;\n        this.explosionTimer = 2;\n        this.explodes = true;\n        this.facing = options.facing || Facing.Left;\n        switch (this.facing) {\n          case Facing.Left: {\n            v2.set(this.v, -400, 300);\n            break;\n          }\n          case Facing.Right: {\n            v2.set(this.v, 400, 300);\n            break;\n          }\n          case Facing.Up: {\n            v2.set(this.v, 0, 500);\n            break;\n          }\n          case Facing.Down: {\n            v2.set(this.v, 0, -500);\n            break;\n          }\n        }\n        break;\n      }\n\n      case EntityType.Explosion: {\n        this.radius = 0;\n        this.damage = 100;\n        this.faction = Faction.Neither;\n        this.harmful = true;\n        this.isExplosion = true;\n        this.flying = true;\n        this.limitedLife = true;\n        this.lifespan = 1;\n        break;\n      }\n\n      case EntityType.Exit: {\n        this.graphic = exitGraphic;\n        this.faction = Faction.Friend;\n        this.radius = 16;\n        this.flying = true;\n        this.onhit = () => {\n          if (level.mcguffinCount === player.mcguffins.length) {\n            nextLevel();\n          } else {\n            if (this.cooldown === 0) {\n              addBanner('Collect more Lava Lamps', 20);\n              sound.play('click2');\n              this.cooldown += 0.5;\n            }\n          }\n        };\n        break;\n      }\n\n      case EntityType.Mcguffin: {\n        this.graphic = mcguffinGraphic;\n        this.faction = Faction.Friend;\n        this.radius = 16;\n        this.onhit = (entity: Entity) => {\n          // TODO: show something to the player about the new effect\n          // TODO: Create some effects\n          entity.mcguffins.push({});\n          addDebuff();\n          sound.play('click');\n          this.die();\n        };\n        break;\n      }\n    }\n\n    if (this.killable) {\n      this.health = this.maxHealth;\n    }\n  }\n\n  update(dT: number) {\n    v2.set(this.dV, 0, 0);\n\n    if (this.weaponTimer > 0) {\n      this.weaponTimer = Math.max(0, this.weaponTimer - dT);\n    }\n\n    if (this.cooldown > 0) {\n      this.cooldown = Math.max(0, this.cooldown - dT);\n    }\n\n    if (this.limitedLife) {\n      this.lifespan -= dT;\n    }\n\n    if (this.lifespan < 0) {\n      return this.die();\n    }\n\n    if (this.health <= 0 && this.killable) {\n      if (debuffs.undead && this !== player) {\n        this.undead = true;\n        this.speed = 0;\n        this.health = 10;\n      } else {\n        return this.die();\n      }\n    }\n\n    if (this.explodes) {\n      this.explosionTimer -= dT;\n      if (this.explosionTimer < 0) {\n        entities.add(new Entity(EntityType.Explosion, this.pos));\n        this.die();\n      }\n    }\n\n    if (this.isExplosion) {\n      this.radius = Math.pow(1 - this.lifespan, 0.5) * 50;\n    }\n\n    if (this.undead && this.speed < 1000) {\n      this.speed += 100 * dT;\n    }\n\n    if (this.ammo === this.ammoMax) {\n      this.ammoTimer = Math.max(0, this.ammoTimer);\n    } else if (this.ammoTimer > 0) {\n      this.ammoTimer -= dT;\n    }\n\n    if (this.ammo < this.ammoMax && this.ammoTimer <= 0) {\n      this.ammo++;\n      this.ammoTimer += this.ammoRegen;\n      if (debuffs.slowRegen) {\n        this.ammoTimer += this.ammoRegen;\n      }\n    }\n\n    if (this.controlled) {\n      this.playerControl(dT);\n    } else {\n      if (this.pacer) {\n        this.dV[0] = this.facing === Facing.Left ? -1 : 1;\n      }\n      if (this.target) {\n        const tVec = v2.create();\n        v2.sub(tVec, this.target.pos, this.pos);\n        const direction = v2.angle(tVec);\n\n        this.facing = this.target.pos[0] < this.pos[0] ? Facing.Left : Facing.Right;\n\n        if (this.weaponRange >= v2.length(tVec)) {\n          this.shoot(this.facing);\n        }\n\n        v2.normalise(tVec, tVec);\n        v2.clone(this.dV, tVec);\n      }\n    }\n\n    v2.mul(this.dV, this.dV, this.speed);\n\n    if (debuffs.fastMonsters && this.faction === Faction.Foe) {\n      v2.mul(this.dV, this.dV, 2);\n    }\n    if (this.undead) {\n      v2.mul(this.dV, this.dV, 0.5);\n    }\n\n    if (!this.onGround && !this.flying) {\n      v2.mul(this.dV, this.dV, 0.2);\n    }\n\n    // Friction\n    const fricAcc = v2.create();\n    v2.mul(fricAcc, this.v, this.onGround ? -8 : -1);\n    v2.add(this.dV, this.dV, fricAcc);\n\n    if (!this.flying) {\n      v2.add(this.dV, this.dV, g);\n    }\n\n    v2.mul(this.dV, this.dV, dT); // a => at\n    // equations of motion\n    // v = at + u\n    v2.add(this.v, this.dV, this.v);\n    // dP = ut + (1/2)at^2\n    const ut = v2.create();\n    v2.mul(ut, this.v, dT);\n    v2.mul(this.dP, this.dV, 0.5 * dT); // dP = (1/2)at^2\n    v2.add(this.dP, ut, this.dP);\n\n    this.onGround = false;\n    if (this.collidable) {\n      let attempts = 4;\n      while (attempts--) {\n        const collision = level.map.findCollision(this);\n        if (collision.time < 1 && !v2.isZero(collision.normal)) {\n          if (collision.normal[1] > 0.5) {\n            this.onGround = true;\n          }\n\n          if (attempts === 0) {\n            v2.set(this.dP, 0, 0);\n          } else {\n            this.updateMove(collision.normal, collision.time);\n          }\n          this.hit(null, dT);\n        }\n      }\n    }\n\n    for (const other of entities) {\n      if (other !== this && other.collidable && this.willCollide(other)) {\n        this.hit(other, dT);\n        other.hit(this, dT);\n        // if (this.solid && other.solid) {\n        //   // TODO: bouncing/deflection here\n        //   v2.set(this.dP, 0, 0);\n        // }\n      }\n    }\n\n    if (this.v[0] !== 0) {\n      this.facing = this.v[0] < 0 ? Facing.Left : Facing.Right;\n    }\n\n    v2.add(this.pos, this.pos, this.dP);\n  }\n\n  shoot(facing: Facing) {\n    if (this.weaponTimer === 0 && this.ammo > 0) {\n      if (this.weaponType === WeaponType.Gun) {\n        entities.add(new Entity(EntityType.Projectile, this.pos, { facing, faction: this.faction }));\n        this.ammo--;\n      } else if (this.weaponType === WeaponType.Grenade) {\n        entities.add(new Entity(EntityType.Grenade, this.pos, { facing, faction: this.faction }));\n        this.ammo -= 10;\n      }\n      sound.play('pop');\n      this.weaponTimer += 0.1;\n    }\n  }\n\n  playerControl(dT: number) {\n    v2.set(this.dV, 0, 0);\n    if (controls.isPressed(Key.Space) && this.onGround) {\n      this.v[1] += 600;\n      sound.play('whoop');\n    }\n    // if (controls.isPressed(Key.S)) {\n    //   this.dV[1] = -1;\n    // }\n    if (controls.isPressed(Key.A)) {\n      this.dV[0] = -1;\n    }\n    if (controls.isPressed(Key.D)) {\n      this.dV[0] = 1;\n    }\n\n    if (controls.isPressed(Key.Up)) {\n      this.shoot(Facing.Up);\n    }\n    if (controls.isPressed(Key.Down)) {\n      this.shoot(Facing.Down);\n    }\n    if (controls.isPressed(Key.Left)) {\n      this.shoot(Facing.Left);\n    }\n    if (controls.isPressed(Key.Right)) {\n      this.shoot(Facing.Right);\n    }\n\n    if (weaponsAvailable.includes(WeaponType.Gun) && controls.isPressed(Key.One)) {\n      this.weaponType = WeaponType.Gun;\n    }\n    if (weaponsAvailable.includes(WeaponType.Grenade) && controls.isPressed(Key.Two)) {\n      this.weaponType = WeaponType.Grenade;\n    }\n\n    v2.normalise(this.dV, this.dV);\n  }\n\n  collisionSupport(direction: V2): V2 {\n    const result = v2.create();\n    v2.normalise(direction, direction);\n    v2.mul(result, direction, this.radius);\n    v2.add(result, this.pos, result);\n    if (!v2.isZero(this.dP)) {\n      const angle = v2.dot(this.dP, direction);\n      if (angle > 0) {\n        v2.add(result, result, this.dP);\n      }\n    }\n    return result;\n  }\n\n  willCollide(other: Entity) {\n    // Assume that all entities are circles for collision\n    const support = this.collisionSupport;\n    return intersect(support.bind(this), support.bind(other));\n  }\n\n  updateMove(normal: V2, proportion: number) {\n    let bounceAmount = 1 - proportion;\n    if (this.collisionResponse === CollisionResponse.Bounce) {\n      bounceAmount += 0.9;\n    }\n\n    switch (this.collisionResponse) {\n      case CollisionResponse.TurnAround: {\n        if (this.dP[0] !== 0) {\n          this.facing = this.facing === Facing.Left ? Facing.Right : Facing.Left;\n        }\n      }\n      case CollisionResponse.Bounce:\n      case CollisionResponse.Deflect: {\n        const vDiff = v2.create();\n        const dpDiff = v2.create();\n\n        v2.mul(dpDiff, normal, bounceAmount * v2.dot(this.dP, normal));\n        v2.sub(this.dP, this.dP, dpDiff);\n\n        v2.mul(vDiff, normal, bounceAmount * v2.dot(this.v, normal));\n        v2.sub(this.v, this.v, vDiff);\n        break;\n      }\n\n      case CollisionResponse.Stop: {\n        v2.set(this.dP, 0, 0);\n        v2.set(this.v, 0, 0);\n        break;\n      }\n    }\n  }\n\n  /**\n   * If other is null then we collided with a wall\n   */\n  hit(other: Entity | null, dT: number) {\n    if (!other) {\n      if (this.harmful && this.destroyOnUse) {\n        this.die();\n      }\n      return;\n    }\n\n    if (this.onhit && other === player) {\n      this.onhit(other);\n    }\n\n    if (this.killable && other.harmful && this.faction !== other.faction) {\n      let damage = other.damage;\n      if (this === player && debuffs.doubleDamage) {\n        damage *= 2;\n      }\n      if (other.destroyOnUse) {\n        this.health -= damage;\n        sound.play('urgh');\n        other.die();\n      } else {\n        if (other.cooldown === 0) {\n          this.health -= damage * 0.25;\n          other.cooldown += 0.25;\n          sound.play('urgh');\n        }\n      }\n    }\n\n    if (this.collectable && this.faction === other.faction) {\n      if (this.health > 0 && other.health < other.maxHealth) {\n        if (!debuffs.noHeal) {\n          other.health = Math.min(other.maxHealth, other.health + this.health);\n        }\n        return this.die();\n      }\n    }\n  }\n\n  die() {\n    entities.delete(this);\n\n    if (this.killable) {\n      sound.play('squelch1');\n    }\n\n    if (this === player) {\n      reset();\n    }\n  }\n}\n","import { drawBanner, drawTopBanner } from './banner';\nimport controls, { Key } from './controls';\nimport { canvas, context } from './display';\nimport Entity, { Facing } from './entity';\nimport { entities, level, paused, player, reset, togglePause, weaponsAvailable, WeaponType } from './gameState';\nimport { bombIconGraphic, gunIconGraphic, spritesLoaded } from './graphic';\nimport { levelsLoaded } from './levels';\nimport { V2, v2 } from './maths';\n\n// The more you have, the worse it gets\n// ====================================\n//\n// Platformer. You must collect, say, 5 mcguffins per level. Each mcguffin adds a\n// complication. Like, you take double damage, or more monsters spawn. Or\n// perhaps visibilty gets worse. Something like that!\n// - Tile based\n// - Totally 2D\n// - Probably not WebGL during the compo\n\n// Weapons:\n// - pistol\n// - sword\n// - machine gun\n// - grenades\n\n// Debuffs:\n// - monsters faster\n// - can't heal\n// - double damage\n// - ammo regen slower\n// Maybe:\n// - can't change weapon\n// - Something that makes spikes harder\n\n// import { buildTime } from 'build-info';\n\n// OKAY, let's code!\n\n// console.log(buildTime);\n\n// Just for the constructor\n\n// URGENT TODOS:\n// - mcguffin effects\n// - title screen?\n// - more levels\n// - spikes!\n// - more creature types - flying? jumping?\n// - make creatures not walk off edges\n// - Better death effect (deadtimer for fade)\n// - 'go fullscreen' icon?\n\nlet lastFrameStart: number = 0;\nlet pauseHeld = false;\n\nfunction loop() {\n  if (lastFrameStart === 0) {\n    lastFrameStart = performance.now();\n  }\n\n  const frameStart = performance.now();\n  const dT = Math.min((frameStart - lastFrameStart) / 1000, 0.2);\n  lastFrameStart = frameStart;\n\n  if (controls.isPressed(Key.P)) {\n    if (!pauseHeld) {\n      togglePause();\n    }\n    pauseHeld = true;\n  } else {\n    pauseHeld = false;\n  }\n\n  context.save();\n\n  context.fillStyle = 'rgb(48, 48, 128)';\n  context.fillRect(0, 0, canvas.width, canvas.height);\n\n  context.translate((canvas.width / 4), (canvas.height / 4));\n  context.scale(1, -1);\n  context.translate(-player.pos[0], -player.pos[1]);\n\n  level.map.draw(context);\n\n  if (!paused) {\n    for (const entity of entities) {\n      entity.update(dT);\n    }\n\n    if (player.pos[1] < 0) {\n      player.die();\n    }\n  }\n\n  for (const entity of entities) {\n    context.save();\n    context.translate(entity.pos[0], entity.pos[1]);\n    if (entity.killable && entity.health < entity.maxHealth && entity !== player) {\n      context.fillStyle = 'red';\n      context.fillRect(-12, entity.radius + 4, 24 * (entity.health / entity.maxHealth), 5);\n    }\n    if (entity.facing === Facing.Left) {\n      context.scale(-1, 1);\n    }\n    if (entity.isExplosion) {\n      context.fillStyle = 'yellow';\n      context.beginPath();\n      context.arc(0, 0, entity.radius, 0, Math.PI * 2);\n      context.fill();\n    } else {\n      context.drawImage(entity.graphic, -entity.graphic.width / 2, -entity.graphic.height / 2);\n    }\n    context.restore();\n  }\n\n  context.restore();\n\n  drawTopBanner(context, dT);\n  drawBanner(context, dT);\n\n  drawGUI();\n\n  requestAnimationFrame(loop);\n}\n\nconst healthGradient = context.createLinearGradient(0, 0, 100, 20);\nhealthGradient.addColorStop(0, 'rgb(128, 0, 0)');\nhealthGradient.addColorStop(1, 'rgb(255, 55, 55)');\n\nfunction drawGUI() {\n  context.strokeStyle = 'white';\n  context.fillStyle = healthGradient;\n  context.fillRect(15, 15, 100 * player.health / player.maxHealth, 20);\n  context.strokeRect(15, 15, 100, 20);\n\n  context.font = '20px \"Fredoka One\", Arial, sans-serif';\n  context.fillStyle = 'white';\n  context.strokeStyle = 'black';\n  context.textBaseline = 'top';\n  context.fillText(String(player.ammo), 130, 15);\n  context.strokeText(String(player.ammo), 130, 15);\n\n  let weaponCounter = 0;\n\n  if (weaponsAvailable.includes(WeaponType.Gun)) {\n    context.fillText('1', 20, 56 + (50 * weaponCounter));\n    context.drawImage(gunIconGraphic, 45, 50 + (50 * weaponCounter));\n    if (player.weaponType === WeaponType.Gun) {\n      context.strokeStyle = 'white';\n      context.strokeRect(15, 45 + (50 * weaponCounter), 67, 42);\n    }\n    weaponCounter++;\n  }\n\n  if (weaponsAvailable.includes(WeaponType.Grenade)) {\n    context.fillText('2', 20, 56 + (50 * weaponCounter));\n    context.drawImage(bombIconGraphic, 45, 50 + (50 * weaponCounter));\n    if (player.weaponType === WeaponType.Grenade) {\n      context.strokeStyle = 'white';\n      context.strokeRect(15, 45 + (50 * weaponCounter), 67, 42);\n    }\n    weaponCounter++;\n  }\n}\n\nfunction init() {\n  reset();\n  requestAnimationFrame(loop);\n}\n\nconst loadingImage = new Image();\nloadingImage.src = 'assets/loading.png';\nloadingImage.onload = () => {\n  context.drawImage(loadingImage, 0, 0, canvas.width / 2, canvas.height / 2);\n  setTimeout(() => {\n    Promise.all([levelsLoaded, spritesLoaded]).then(init);\n  }, 3000);\n};\n"],"names":["context"],"mappings":";;AAAA,MAAM,WAAW,GAA0C,EAAE,CAAC;AAC9D,MAAM,cAAc,GAA0C,EAAE,CAAC;AAEjE,mBAA0B,IAAY,EAAE,IAAY;IAClD,IAAI,aAAa,KAAK,IAAI,EAAE;QAC1B,OAAO;KACR;IACD,KAAK,MAAM,MAAM,IAAI,WAAW,EAAE;QAChC,IAAI,IAAI,KAAK,MAAM,CAAC,IAAI,EAAE;YACxB,OAAO;SACR;KACF;IACD,WAAW,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;CAClC;AAED,sBAA6B,IAAY,EAAE,IAAY;IACrD,IAAI,gBAAgB,KAAK,IAAI,EAAE;QAC7B,OAAO;KACR;IACD,KAAK,MAAM,MAAM,IAAI,cAAc,EAAE;QACnC,IAAI,IAAI,KAAK,MAAM,CAAC,IAAI,EAAE;YACxB,OAAO;SACR;KACF;IACD,cAAc,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;CACrC;AAED,IAAI,YAAY,GAAG,CAAC,CAAC;AACrB,IAAI,aAAa,GAAW,EAAE,CAAC;AAC/B,IAAI,WAAW,GAAG,EAAE,CAAC;AACrB,MAAM,QAAQ,GAAG,CAAC,CAAC;AAEnB,IAAI,eAAe,GAAG,CAAC,CAAC;AACxB,IAAI,gBAAgB,GAAW,EAAE,CAAC;AAClC,IAAI,cAAc,GAAG,EAAE,CAAC;AACxB,MAAM,YAAY,GAAG,CAAC,CAAC;AAEvB,oBAA2B,OAAiC,EAAE,EAAU;IACtE,IAAI,YAAY,IAAI,CAAC,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;QAC/C,YAAY,GAAG,QAAQ,CAAC;QACxB,MAAM,OAAO,GAAG,WAAW,CAAC,KAAK,EAAG,CAAC;QACrC,aAAa,GAAG,OAAO,CAAC,IAAI,CAAC;QAC7B,WAAW,GAAG,OAAO,CAAC,IAAI,CAAC;KAC5B;IAED,IAAI,YAAY,GAAG,CAAC,EAAE;QACpB,YAAY,IAAI,EAAE,CAAC;KACpB;SAAM;QACL,aAAa,GAAG,EAAE,CAAC;QACnB,OAAO;KACR;IAED,OAAO,CAAC,IAAI,EAAE,CAAC;IACf,IAAI,YAAY,GAAG,GAAG,EAAE;QACtB,OAAO,CAAC,WAAW,GAAG,CAAC,IAAI,CAAC,YAAY,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC;KACtD;IACD,IAAI,YAAY,GAAG,GAAG,EAAE;QACtB,OAAO,CAAC,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,YAAY,GAAG,CAAC,CAAC,CAAC;KACrD;IACD,OAAO,CAAC,IAAI,GAAG,GAAG,WAAW,gCAAgC,CAAC;IAC9D,OAAO,CAAC,YAAY,GAAG,QAAQ,CAAC;IAChC,OAAO,CAAC,SAAS,GAAG,OAAO,CAAC;IAC5B,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC;IAC9B,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,WAAW,GAAG,EAAE,CAAC,CAAC;IAClD,OAAO,CAAC,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,WAAW,GAAG,CAAC,CAAC,CAAC;IACrD,OAAO,CAAC,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,WAAW,GAAG,CAAC,CAAC,CAAC;IAErD,MAAM,KAAK,GAAG,OAAO,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,KAAK,CAAC;IAEvD,OAAO,CAAC,QAAQ,CAAC,aAAa,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,EAAE,OAAO,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;IACvG,OAAO,CAAC,UAAU,CAAC,aAAa,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,EAAE,OAAO,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;IACzG,OAAO,CAAC,OAAO,EAAE,CAAC;CACnB;AAED,uBAA8B,OAAiC,EAAE,EAAU;IACzE,IAAI,eAAe,IAAI,CAAC,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;QACrD,eAAe,GAAG,YAAY,CAAC;QAC/B,MAAM,OAAO,GAAG,cAAc,CAAC,KAAK,EAAG,CAAC;QACxC,gBAAgB,GAAG,OAAO,CAAC,IAAI,CAAC;QAChC,cAAc,GAAG,OAAO,CAAC,IAAI,CAAC;KAC/B;IAED,IAAI,eAAe,GAAG,CAAC,EAAE;QACvB,eAAe,IAAI,EAAE,CAAC;KACvB;SAAM;QACL,gBAAgB,GAAG,EAAE,CAAC;QACtB,OAAO;KACR;IAED,OAAO,CAAC,IAAI,EAAE,CAAC;IACf,IAAI,eAAe,GAAG,GAAG,EAAE;QACzB,OAAO,CAAC,WAAW,GAAG,CAAC,IAAI,CAAC,eAAe,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC;KACzD;IACD,IAAI,eAAe,GAAG,GAAG,EAAE;QACzB,OAAO,CAAC,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,eAAe,GAAG,CAAC,CAAC,CAAC;KACxD;IACD,OAAO,CAAC,IAAI,GAAG,GAAG,cAAc,gCAAgC,CAAC;IACjE,OAAO,CAAC,YAAY,GAAG,QAAQ,CAAC;IAChC,OAAO,CAAC,SAAS,GAAG,OAAO,CAAC;IAC5B,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC;IAC9B,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,cAAc,GAAG,EAAE,CAAC,CAAC;IACrD,OAAO,CAAC,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,cAAc,GAAG,CAAC,CAAC,CAAC;IACxD,OAAO,CAAC,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,cAAc,GAAG,CAAC,CAAC,CAAC;IAExD,MAAM,KAAK,GAAG,OAAO,CAAC,WAAW,CAAC,gBAAgB,CAAC,CAAC,KAAK,CAAC;IAE1D,OAAO,CAAC,QAAQ,CAAC,gBAAgB,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,EAAE,OAAO,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;IAC1G,OAAO,CAAC,UAAU,CAAC,gBAAgB,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,EAAE,OAAO,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;IAC5G,OAAO,CAAC,OAAO,EAAE,CAAC;CACnB;;;;IC5GC,MAAM,IAAI,KAAK,CAAC,uBAAuB,CAAC,CAAC;CAC1C;;;;AAKD,kBAAyB,CAAS,EAAE,CAAS,EAAE,CAAS;IACtD,IAAI,CAAC,KAAK,CAAC,EAAE;QACX,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;KAClB;IACD,IAAI,CAAC,IAAI,GAAG,EAAE;QACZ,CAAC,GAAG,CAAC,CAAC;KACP;IACD,CAAC,IAAI,EAAE,CAAC;IAER,MAAM,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IACxB,MAAM,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC;IACjB,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;IACtB,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;IAC7B,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;IAEnC,QAAQ,CAAC;QACP,KAAK,CAAC;YACJ,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QACnB,KAAK,CAAC;YACJ,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QACnB,KAAK,CAAC;YACJ,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QACnB,KAAK,CAAC;YACJ,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QACnB,KAAK,CAAC;YACJ,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QACnB,KAAK,CAAC,CAAC;QACP;YACE,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;KACpB;CACF;AAED,eAAsB,KAAa,EAAE,GAAW,EAAE,GAAW;IAC3D,OAAO,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,CAAC;CAC5C;;;ACvCM,MAAM,MAAM,GAAG,QAAQ,CAAC,cAAc,CAAC,QAAQ,CAAuB,CAAC;AAC9E,AAAO,MAAM,OAAO,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;AAExD,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC;AACpB,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC;AACrB,MAAM,YAAY,GAAG,MAAM,CAAC,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC;;AAElD,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAEpB;IACE,MAAM,MAAM,GAAG,MAAM,CAAC,UAAU,GAAG,MAAM,CAAC,WAAW,CAAC;IACtD,IAAI,MAAM,GAAG,YAAY,EAAE;QACzB,MAAM,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC,WAAW,GAAG,IAAI,CAAC;QAChD,MAAM,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,MAAM,CAAC,UAAU,GAAG,YAAY,GAAG,MAAM,IAAI,IAAI,CAAC;KACzE;SAAM;QACL,MAAM,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC,UAAU,GAAG,IAAI,CAAC;QAC9C,MAAM,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,MAAM,CAAC,WAAW,GAAG,MAAM,GAAG,YAAY,IAAI,IAAI,CAAC;KAC3E;CACF;AAED,MAAM,EAAE,CAAC;AACT,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;AAC1C,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE;IAC/B,MAAM,CAAC,uBAAuB,EAAE,CAAC;CAClC,CAAC,CAAC;AAEH,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;;;AC1BlC,IAAY,GAgBX;AAhBD,WAAY,GAAG;IACb,gCAAU,CAAA;IAEV,8BAAS,CAAA;IACT,0BAAO,CAAA;IACP,gCAAU,CAAA;IACV,8BAAS,CAAA;IAET,4BAAQ,CAAA;IACR,4BAAQ,CAAA;IAER,wBAAM,CAAA;IACN,wBAAM,CAAA;IACN,wBAAM,CAAA;IACN,wBAAM,CAAA;IACN,wBAAM,CAAA;CACP,EAhBW,GAAG,KAAH,GAAG,QAgBd;AAED,MAAM,QAAQ,GAA+B,EAAE,CAAC;AAEhD,MAAM,QAAQ,GAAG;IACf,SAAS,CAAC,GAAW;QACnB,OAAO,QAAQ,CAAC,GAAG,CAAC,CAAC;KACtB;CACF,CAAC;AAEF,iBAAiB,CAAgB;IAC/B,QAAQ,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC;IAC3B,IAAI,CAAC,QAAQ,CAAC,uBAAuB,EAAE;QACrC,MAAM,CAAC,uBAAuB,EAAE,CAAC;KAClC;CACF;AAED,eAAe,CAAgB;IAC7B,QAAQ,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,KAAK,CAAC;CAC7B;AAED,QAAQ,CAAC,gBAAgB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;AAC9C,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;;ACtCnC,MAAM,EAAE,GAAG;IAChB,MAAM,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC;QACjB,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;KACf;IAED,GAAG,CAAC,MAAU,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC;QAC1B,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;QACd,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;KACf;IAED,KAAK,CAAC,MAAU,EAAE,CAAK;QACrB,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QACjB,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;KAClB;IAED,MAAM,CAAC,CAAK;QACV,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;KACjC;IAED,SAAS,CAAC,MAAU,EAAE,CAAK;QACzB,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE;YACjB,MAAM,MAAM,GAAG,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;YAC5B,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC;YAC1B,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC;SAC3B;KACF;IAED,aAAa,CAAC,CAAK;QACjB,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;KAC9B;IAED,MAAM,CAAC,CAAK;QACV,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC;KACvC;IAED,eAAe,CAAC,CAAK,EAAE,CAAK;QAC1B,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;KAChD;IAED,QAAQ,CAAC,CAAK,EAAE,CAAK;QACnB,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;KAC9C;IAED,KAAK,CAAC,CAAK;QACT,OAAO,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;KAC/B;IAED,GAAG,CAAC,MAAU,EAAE,CAAK,EAAE,CAAK;QAC1B,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QACxB,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;KACzB;IAED,GAAG,CAAC,MAAU,EAAE,CAAK,EAAE,CAAK;QAC1B,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QACxB,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;KACzB;IAED,GAAG,CAAC,MAAU,EAAE,CAAK,EAAE,MAAc;QACnC,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC;QAC1B,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC;KAC3B;IAED,MAAM,CAAC,MAAU,EAAE,CAAK,EAAE,KAAa;QACrC,MAAM,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QAC1B,MAAM,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QAC1B,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QACf,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAEf,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QAC1B,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;KAC3B;IAED,MAAM,CAAC,MAAU,EAAE,CAAK;QACtB,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAClB,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;KACnB;IAED,GAAG,CAAC,CAAK,EAAE,CAAK;QACd,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;KAClC;CACF,CAAC;;;AClFF;AACA,AAIA,MAAM,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC;AACvB,MAAM,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC;AACvB,MAAM,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC;AAEvB,gBAAgB,OAAa,EAAE,SAAa;IAC1C,MAAM,IAAI,GAAO,OAAO,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IAC7C,MAAM,CAAC,GAAG,OAAO,CAAC,MAAM,CAAC;IACzB,IAAI,CAAC,KAAK,CAAC,EAAE;QACX,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACxB,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACxB,OAAO,KAAK,CAAC;KACd;IACD,EAAE,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;IACpB,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;IAE7B,IAAI,CAAC,KAAK,CAAC,EAAE;QACX,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACtB,SAAS,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;QAErB,IAAI,EAAE,CAAC,GAAG,CAAC,SAAS,EAAE,EAAE,CAAC,GAAG,CAAC,EAAE;YAC7B,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YAC7B,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;SAC9B;QAED,OAAO,KAAK,CAAC;KACd;IAED,IAAI,CAAC,KAAK,CAAC,EAAE;QACX,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACtB,SAAS,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;QAErB,IAAI,EAAE,CAAC,GAAG,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;YACrC,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YAC7B,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;SAC9B;QAED,IAAI,EAAE,CAAC,GAAG,CAAC,SAAS,EAAE,EAAE,CAAC,GAAG,CAAC,EAAE;YAC7B,OAAO,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;YACxB,MAAM,GAAG,GAAG,OAAO,CAAC,GAAG,EAAG,CAAC;YAE3B,OAAO,KAAK,CAAC;SACd;QAED,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;QAC7B,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACtB,SAAS,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;QAErB,IAAI,EAAE,CAAC,GAAG,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;YACrC,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YAC7B,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;SAC9B;QAED,IAAI,EAAE,CAAC,GAAG,CAAC,SAAS,EAAE,EAAE,CAAC,GAAG,CAAC,EAAE;YAC7B,OAAO,CAAC,KAAK,EAAE,CAAC;YAChB,OAAO,KAAK,CAAC;SACd;QAED,OAAO,IAAI,CAAC;KACb;IACD,OAAO,KAAK,CAAC;CACd;AAED,MAAM,gBAAgB,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC;AAErC,wBAA+B,QAAyB,EAAE,QAAyB;;IAEjF,OAAO,CAAC,SAAa;QACnB,EAAE,CAAC,MAAM,CAAC,gBAAgB,EAAE,SAAS,CAAC,CAAC;QACvC,MAAM,EAAE,GAAG,QAAQ,CAAC,SAAS,CAAC,CAAC;QAC/B,MAAM,EAAE,GAAG,QAAQ,CAAC,gBAAgB,CAAC,CAAC;QACtC,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;QACnB,OAAO,EAAE,CAAC;KACX,CAAC;CACH;AAED,mBAA0B,QAAyB,EAAE,QAAyB;IAC5E,OAAO,YAAY,CAAC,cAAc,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC,CAAC;CACzD;AAED,sBAAsB,OAAwB;IAC5C,MAAM,OAAO,GAAS,EAAE,CAAC;IACzB,MAAM,SAAS,GAAG,EAAE,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAClC,OAAO,IAAI,EAAE;QACX,MAAM,CAAC,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC;QAC7B,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE,SAAS,CAAC,GAAG,CAAC,EAAE;YAC5B,OAAO,KAAK,CAAC;SACd;QAED,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAEhB,IAAI,MAAM,CAAC,OAAO,EAAE,SAAS,CAAC,EAAE;YAC9B,OAAO,IAAI,CAAC;SACb;KACF;CACF;;;ACnGD,IAAY,UAYX;AAZD,WAAY,UAAU;IACpB,+CAAM,CAAA;IACN,6CAAK,CAAA;IACL,mDAAQ,CAAA;IACR,+CAAM,CAAA;IACN,2DAAY,CAAA;IACZ,uDAAU,CAAA;IACV,2CAAI,CAAA;IACJ,+CAAM,CAAA;IACN,iDAAO,CAAA;IACP,qDAAS,CAAA;IACT,8DAAa,CAAA;CACd,EAZW,UAAU,KAAV,UAAU,QAYrB;;;ACND,MAAM,SAAS,GAAG,EAAE,CAAC;AAErB,MAAM,UAAU,GAA2C,EAAE,CAAC;AAE9D,MAAM,CAAC,GAAG,CAAC,CAAC;AACZ,MAAM,KAAK,GAAG,GAAG,CAAC;AAClB,MAAM,IAAI,GAAG,GAAG,CAAC;AACjB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,EAAE;IAC3B,MAAM,CAAC,GAAG,CAAC,GAAG,GAAG,EAAE,IAAI,CAAC,CAAC;IACzB,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;IACxC,MAAM,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,GAAG,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;IAC1C,UAAU,CAAC,CAAC,CAAC,GAAG;QACd,IAAI,EAAE,OAAO,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,GAAG,CAAC,KAAK,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,GAAG,CAAC,KAAK,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,GAAG,CAAC,EAAE;QACrF,KAAK,EAAE,OAAO,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,GAAG,CAAC,KAAK,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,GAAG,CAAC,KAAK,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,GAAG,CAAC,EAAE;KACpF,CAAC;CACH;AAEc;IAQb,YAAY,IAAe;QAP3B,iBAAY,GAAuB,EAAE,CAAC;QAK9B,eAAU,GAAqB,EAAE,CAAC;QAGxC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QAEjB,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,MAAM,EAAE;YAC/B,IAAI,KAAK,CAAC,IAAI,KAAK,WAAW,EAAE;gBAC9B,MAAM,SAAS,GAAG,KAAuB,CAAC;gBAC1C,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;gBAChC,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC;gBAC7B,IAAI,CAAC,MAAM,GAAG,SAAS,CAAC,MAAM,CAAC;gBAC/B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;oBAC9C,IAAI,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE;wBAC3B,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;qBACxD;iBACF;aACF;iBAAM,IAAI,KAAK,CAAC,IAAI,KAAK,aAAa,EAAE;gBACvC,MAAM,WAAW,GAAG,KAAyB,CAAC;gBAC9C,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;aACrC;SACF;KACF;IAED,YAAY,CAAC,CAAS,EAAE,CAAS;QAC/B,OAAO,CAAC,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,KAAK,IAAI,CAAC,CAAC;KACjD;IAED,uBAAuB,CAAC,CAAS,EAAE,CAAS;QAC1C,OAAO,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,MAAM,GAAG,SAAS,IAAI,EAAE,GAAG,CAAC,CAAC,CAAC;KAChD;IAED,WAAW,CAAC,MAAc,EAAE,KAAa,EAAE,KAAa;QACtD,MAAM,aAAa,GAAG,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAC3D,MAAM,WAAW,GAAG,CAAC,SAAa;YAChC,MAAM,MAAM,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,GAAG,SAAS,EAAE,KAAK,GAAG,SAAS,CAAC,CAAC;YAC/D,IAAI,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;gBACpB,MAAM,CAAC,CAAC,CAAC,IAAI,SAAS,CAAC;aACxB;YACD,IAAI,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;gBACpB,MAAM,CAAC,CAAC,CAAC,IAAI,SAAS,CAAC;aACxB;YACD,OAAO,MAAM,CAAC;SACf,CAAC;QACF,OAAO,SAAS,CAAC,aAAa,EAAE,WAAW,CAAC,CAAC;KAC9C;IAED,aAAa,CAAC,MAAc;QAC1B,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC;QACvE,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC;QACvE,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC;QACvE,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC;QAEvE,MAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC,CAAC;QAC3D,MAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC,CAAC;QAC3D,MAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC;QAC9C,MAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC;QAE9C,MAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC;QAC3D,MAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC;QAE3D,MAAM,MAAM,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QACtB,IAAI,QAAQ,GAAG,CAAC,CAAC;QAEjB,KAAK,IAAI,CAAC,GAAG,QAAQ,EAAE,CAAC,IAAI,QAAQ,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC5D,KAAK,IAAI,CAAC,GAAG,QAAQ,EAAE,CAAC,IAAI,QAAQ,IAAI,CAAC,GAAG,IAAI,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE;gBAC3D,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE;oBAC1D,IAAI,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE;wBAClC,MAAM,UAAU,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;wBAC1B,IAAI,QAAQ,GAAG,CAAC,CAAC;wBACjB,MAAM,QAAQ,GAAG,CAAC,GAAG,SAAS,CAAC;wBAC/B,MAAM,SAAS,GAAG,QAAQ,GAAG,SAAS,CAAC;wBACvC,MAAM,UAAU,GAAG,CAAC,GAAG,SAAS,CAAC;wBACjC,MAAM,OAAO,GAAG,UAAU,GAAG,SAAS,CAAC;wBAEvC,IAAI,OAAO,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;4BAC3B,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;4BAClB,IAAI,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;gCACpB,MAAM,QAAQ,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,SAAS,KAAK,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC;gCACzE,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,GAAG,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;6BACxD;yBACF;6BAAM,IAAI,UAAU,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;4BACrC,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;4BACnB,IAAI,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;gCACpB,MAAM,QAAQ,GAAG,CAAC,CAAC,GAAG,SAAS,KAAK,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC;gCACnE,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,GAAG,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;6BACxD;yBACF;6BAAM,IAAI,SAAS,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;4BACpC,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;4BAClB,IAAI,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;gCACpB,MAAM,QAAQ,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,SAAS,KAAK,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC;gCACzE,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,GAAG,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;6BACxD;yBACF;6BAAM,IAAI,QAAQ,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;4BACnC,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;4BACnB,IAAI,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;gCACpB,MAAM,QAAQ,GAAG,CAAC,CAAC,GAAG,SAAS,KAAK,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC;gCACnE,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,GAAG,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;6BACxD;yBACF;;;wBAKD,IAAI,QAAQ,IAAI,CAAC,IAAI,QAAQ,IAAI,QAAQ,EAAE;4BACzC,QAAQ,GAAG,QAAQ,CAAC;4BACpB,EAAE,CAAC,KAAK,CAAC,MAAM,EAAE,UAAU,CAAC,CAAC;yBAC9B;qBACF;iBACF;aACF;SACF;QACD,EAAE,CAAC,SAAS,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;QAC7B,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC;KACnC;;;;IAKD,IAAI,CAAC,OAAiC;QACpC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACpC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE;gBACnC,MAAM,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;gBAC9D,IAAI,IAAI,KAAK,CAAC,EAAE;oBACd,OAAO,CAAC,SAAS,GAAG,UAAU,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC;oBAC3C,OAAO,CAAC,QAAQ,EAAE,CAAC,GAAG,SAAS,IAAI,CAAC,GAAG,SAAS,GAAG,SAAS,EAAE,SAAS,CAAC,CAAC;oBACzE,OAAO,CAAC,SAAS,GAAG,UAAU,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC;oBAC1C,OAAO,CAAC,SAAS,EAAE,CAAC;oBACpB,OAAO,CAAC,MAAM,EAAE,CAAC,GAAG,SAAS,IAAI,CAAC,GAAG,SAAS,EAAE,CAAC;oBACjD,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,GAAG,CAAC,IAAI,SAAS,IAAI,CAAC,GAAG,SAAS,EAAE,CAAC;oBACvD,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,GAAG,CAAC,IAAI,SAAS,IAAI,CAAC,CAAC,GAAG,CAAC,IAAI,SAAS,EAAE,CAAC;oBAC7D,OAAO,CAAC,SAAS,EAAE,CAAC;oBACpB,OAAO,CAAC,IAAI,EAAE,CAAC;;;iBAGhB;aACF;SACF;KACF;CACF;;AClKD,MAAM,UAAU,GAAG,CAAC,aAAa,EAAE,aAAa,EAAE,aAAa,CAAC,CAAC;AACjE,MAAM,MAAM,GAAY,EAAE,CAAC;AAE3B,AAAO,MAAM,YAAY,GAAG,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;AAEnE,kBAAyB,EAAU;IACjC,OAAO,MAAM,CAAC,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC;CACnC;AAED,yBAAyB,IAAY,EAAE,KAAa;IAClD,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,UAAU,IAAI,EAAE,CAAC,CAAC;IAC/C,MAAM,IAAI,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;IACnC,MAAM,GAAG,GAAG,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAC;IAC/B,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC;IAC7B,MAAM,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC;CACvB;;AAGD,IAAK,aAUJ;AAVD,WAAK,aAAa;IAChB,oDAAU,CAAA;IACV,kDAAS,CAAA;IACT,4DAAc,CAAA;IACd,4DAAc,CAAA;IACd,4DAAc,CAAA;IACd,qEAAmB,CAAA;IACnB,2DAAc,CAAA;IACd,qDAAW,CAAA;IACX,uDAAY,CAAA;CACb,EAVI,aAAa,KAAb,aAAa,QAUjB;AAED,MAAM,iBAAiB,GAAgC;IACrD,CAAC,aAAa,CAAC,IAAI,GAAG,UAAU,CAAC,IAAI;IACrC,CAAC,aAAa,CAAC,SAAS,GAAG,UAAU,CAAC,MAAM;IAC5C,CAAC,aAAa,CAAC,SAAS,GAAG,UAAU,CAAC,YAAY;IAClD,CAAC,aAAa,CAAC,KAAK,GAAG,UAAU,CAAC,KAAK;IACvC,CAAC,aAAa,CAAC,QAAQ,GAAG,UAAU,CAAC,QAAQ;IAC7C,CAAC,aAAa,CAAC,MAAM,GAAG,UAAU,CAAC,MAAM;IACzC,CAAC,aAAa,CAAC,aAAa,GAAG,UAAU,CAAC,aAAa;CACxD,CAAC;AAEK;IAIL,YAAmB,GAAa;QAAb,QAAG,GAAH,GAAG,CAAU;QAHhC,UAAK,GAAO,EAAE,CAAC,MAAM,EAAE,CAAC;QACxB,kBAAa,GAAG,CAAC,CAAC;;QAIhB,KAAK,MAAM,KAAK,IAAI,GAAG,CAAC,YAAY,EAAE;YACpC,KAAK,MAAM,GAAG,IAAI,KAAK,CAAC,OAAO,EAAE;gBAC/B,MAAM,IAAI,GAAG,GAAG,CAAC,GAAoB,CAAC;gBACtC,IAAI,IAAI,KAAK,aAAa,CAAC,KAAK,EAAE;oBAChC,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,uBAAuB,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;iBACjE;gBACD,IAAI,IAAI,KAAK,aAAa,CAAC,QAAQ,EAAE;oBACnC,IAAI,CAAC,aAAa,EAAE,CAAC;iBACtB;aACF;SACF;KACF;IAED,WAAW;QACT,MAAM,MAAM,GAAa,EAAE,CAAC;QAE5B,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE;YACzC,KAAK,MAAM,GAAG,IAAI,KAAK,CAAC,OAAO,EAAE;gBAC/B,MAAM,IAAI,GAAG,GAAG,CAAC,GAAoB,CAAC;gBACtC,IAAI,iBAAiB,CAAC,IAAI,CAAC,EAAE;oBAC3B,MAAM,CAAC,IAAI,CAAC,IAAI,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,uBAAuB,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;iBAClG;aACF;SACF;QACD,OAAO,MAAM,CAAC;KACf;CACF;;ACvED,IAAY,UAGX;AAHD,WAAY,UAAU;IACpB,yCAAG,CAAA;IACH,iDAAO,CAAA;CACR,EAHW,UAAU,KAAV,UAAU,QAGrB;AAED,AAAO,MAAM,QAAQ,GAAgB,IAAI,GAAG,EAAE,CAAC;AAC/C,AAAO,IAAI,MAAc,CAAC;AAC1B,AAAO,IAAI,KAAY,CAAC;AACxB,AAAO,IAAI,MAAM,GAAG,KAAK,CAAC;AAC1B,AAAO,MAAM,gBAAgB,GAAiB,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;AAC/D,AAAO,MAAM,OAAO,GAAG;IACrB,YAAY,EAAE,KAAK;IACnB,YAAY,EAAE,KAAK;IACnB,MAAM,EAAE,KAAK;IACb,SAAS,EAAE,KAAK;IAChB,MAAM,EAAE,KAAK;CACd,CAAC;AAEF,IAAI,cAAc,GAAG,CAAC,CAAC;AAEvB;IACE,MAAM,GAAG,IAAI,MAAM,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC;IACjD,WAAW,CAAC,cAAc,CAAC,CAAC;CAC7B;AAED;IACE,MAAM,GAAG,CAAC,MAAM,CAAC;CAClB;AAED;IACE,WAAW,CAAC,cAAc,GAAG,CAAC,CAAC,CAAC;CACjC;AAED;IACE,MAAM,SAAS,GAAa,EAAE,CAAC;IAE/B,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE;QACzB,SAAS,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;KAChC;IACD,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;QACnB,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;KAC1B;IACD,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE;QACzB,SAAS,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;KAChC;IACD,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;QACtB,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;KAC7B;IACD,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;QACnB,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;KAC1B;IAED,MAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC;IAE5D,QAAQ,SAAS,CAAC,MAAM,CAAC;QACvB,KAAK,cAAc,EAAE;YACnB,OAAO,CAAC,YAAY,GAAG,IAAI,CAAC;YAC5B,SAAS,CAAC,wBAAwB,EAAE,EAAE,CAAC,CAAC;YACxC,MAAM;SACP;QACD,KAAK,cAAc,EAAE;YACnB,OAAO,CAAC,YAAY,GAAG,IAAI,CAAC;YAC5B,SAAS,CAAC,qBAAqB,EAAE,EAAE,CAAC,CAAC;YACrC,MAAM;SACP;QACD,KAAK,QAAQ,EAAE;YACb,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC;YACtB,SAAS,CAAC,mBAAmB,EAAE,EAAE,CAAC,CAAC;YACnC,MAAM;SACP;QACD,KAAK,WAAW,EAAE;YAChB,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC;YACzB,SAAS,CAAC,uBAAuB,EAAE,EAAE,CAAC,CAAC;YACvC,MAAM;SACP;QACD,KAAK,QAAQ,EAAE;YACb,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC;YACtB,SAAS,CAAC,gCAAgC,EAAE,EAAE,CAAC,CAAC;YAChD,MAAM;SACP;KACF;CACF;AAED,qBAA4B,EAAU;IACpC,YAAY,CAAC,SAAS,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IACpC,IAAI,EAAE,KAAK,CAAC,EAAE;QACZ,SAAS,CAAC,eAAe,EAAE,EAAE,CAAC,CAAC;QAC/B,SAAS,CAAC,eAAe,EAAE,EAAE,CAAC,CAAC;QAC/B,SAAS,CAAC,kBAAkB,EAAE,EAAE,CAAC,CAAC;QAClC,SAAS,CAAC,4CAA4C,EAAE,EAAE,CAAC,CAAC;QAC5D,SAAS,CAAC,6CAA6C,EAAE,EAAE,CAAC,CAAC;QAC7D,SAAS,CAAC,qBAAqB,EAAE,EAAE,CAAC,CAAC;KACtC;IAED,OAAO,CAAC,YAAY,GAAG,KAAK,CAAC;IAC7B,OAAO,CAAC,YAAY,GAAG,KAAK,CAAC;IAC7B,OAAO,CAAC,MAAM,GAAG,KAAK,CAAC;IACvB,OAAO,CAAC,SAAS,GAAG,KAAK,CAAC;IAC1B,OAAO,CAAC,MAAM,GAAG,KAAK,CAAC;IAEvB,cAAc,GAAG,EAAE,CAAC;IACpB,KAAK,GAAG,QAAQ,CAAC,EAAE,CAAC,CAAC;IACrB,QAAQ,CAAC,KAAK,EAAE,CAAC;IACjB,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC;IAClC,MAAM,CAAC,SAAS,GAAG,EAAE,CAAC;IACtB,MAAM,aAAa,GAAG,KAAK,CAAC,WAAW,EAAE,CAAC;IAC1C,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;IACrB,KAAK,MAAM,MAAM,IAAI,aAAa,EAAE;QAClC,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;KACtB;CACF;;;AChHD,MAAM,WAAW,GAAqB,IAAI,KAAK,EAAE,CAAC;AAElD,AAAO,MAAM,aAAa,GAAG,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM;IACvD,WAAW,CAAC,MAAM,GAAG,OAAO,CAAC;IAC7B,WAAW,CAAC,OAAO,GAAG,MAAM,CAAC;CAC9B,CAAC,CAAC;AAEH,WAAW,CAAC,GAAG,GAAG,oBAAoB,CAAC;AAEvC,mBAAmB,KAAa,EAAE,MAAc;IAC9C,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;IAEhD,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC;IACrB,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC;IAEvB,MAAM,OAAO,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;IAEjD,OAAO,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;CAC1B;AAED,2BAA2B,KAAa;IACtC,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,GAAG,SAAS,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IAE5C,OAAO,CAAC,SAAS,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IAC1B,OAAO,CAAC,SAAS,GAAG,KAAK,CAAC;IAC1B,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC;IAC9B,OAAO,CAAC,SAAS,EAAE,CAAC;IACpB,OAAO,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC;IAC5C,OAAO,CAAC,IAAI,EAAE,CAAC;IACf,OAAO,CAAC,MAAM,EAAE,CAAC;IACjB,OAAO,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAE9B,OAAO,MAAM,CAAC;CACf;AAED;IACE,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,GAAG,SAAS,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IAE5C,OAAO,CAAC,SAAS,GAAG,QAAQ,CAAC;IAC7B,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC;IAC9B,OAAO,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;IAC/B,OAAO,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;IAEjC,OAAO,MAAM,CAAC;CACf;AAED;IACE,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,GAAG,SAAS,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IAE5C,OAAO,CAAC,SAAS,GAAG,MAAM,CAAC;IAC3B,OAAO,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;IAE/B,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC;IAC9B,OAAO,CAAC,SAAS,EAAE,CAAC;IACpB,OAAO,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IACrB,OAAO,CAAC,MAAM,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IACvB,OAAO,CAAC,MAAM,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;IACtB,OAAO,CAAC,MAAM,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;IACtB,OAAO,CAAC,MAAM,EAAE,CAAC;IAEjB,OAAO,MAAM,CAAC;CACf;AAED;IACE,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,GAAG,SAAS,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IAE5C,OAAO,CAAC,SAAS,GAAG,QAAQ,CAAC;IAC7B,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC;IAE9B,OAAO,CAAC,SAAS,EAAE,CAAC;IACpB,OAAO,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC;IAC5C,OAAO,CAAC,IAAI,EAAE,CAAC;IACf,OAAO,CAAC,MAAM,EAAE,CAAC;IAEjB,OAAO,MAAM,CAAC;CACf;AAED;IACE,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,GAAG,SAAS,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IAE5C,OAAO,CAAC,SAAS,GAAG,OAAO,CAAC;IAC5B,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC;IAE9B,OAAO,CAAC,SAAS,EAAE,CAAC;IACpB,OAAO,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC;IAC5C,OAAO,CAAC,IAAI,EAAE,CAAC;IACf,OAAO,CAAC,SAAS,EAAE,CAAC;IACpB,OAAO,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IACrB,OAAO,CAAC,MAAM,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IACvB,OAAO,CAAC,MAAM,EAAE,CAAC;IACjB,OAAO,CAAC,WAAW,GAAG,QAAQ,CAAC;IAE/B,OAAO,CAAC,SAAS,EAAE,CAAC;IACpB,OAAO,CAAC,MAAM,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IACvB,OAAO,CAAC,MAAM,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IACvB,OAAO,CAAC,MAAM,EAAE,CAAC;IAEjB,OAAO,MAAM,CAAC;CACf;AAED;IACE,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,GAAG,SAAS,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IAE5C,MAAM,KAAK,GAAG,CAAC,CAAC;IAChB,MAAM,KAAK,GAAG,CAAC,CAAC;IAEhB,aAAa,CAAC,IAAI,CAAC;QACjB,OAAO,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QACzB,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACrB,OAAO,CAAC,SAAS,CAAC,WAAW,EAAE,KAAK,GAAG,EAAE,EAAE,KAAK,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;KAC9E,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC;CACf;AAED;IACE,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,GAAG,SAAS,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IAE5C,MAAM,KAAK,GAAG,CAAC,CAAC;IAChB,MAAM,KAAK,GAAG,CAAC,CAAC;IAEhB,aAAa,CAAC,IAAI,CAAC;QACjB,OAAO,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QACzB,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACrB,OAAO,CAAC,SAAS,CAAC,WAAW,EAAE,KAAK,GAAG,EAAE,EAAE,KAAK,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;KAC9E,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC;CACf;AAED;IACE,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,GAAG,SAAS,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IAE5C,MAAM,KAAK,GAAG,CAAC,CAAC;IAChB,MAAM,KAAK,GAAG,CAAC,CAAC;IAEhB,aAAa,CAAC,IAAI,CAAC;QACjB,OAAO,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QACzB,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACrB,OAAO,CAAC,SAAS,CAAC,WAAW,EAAE,KAAK,GAAG,EAAE,EAAE,KAAK,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;KAC9E,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC;CACf;AAED;IACE,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,GAAG,SAAS,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IAE5C,MAAM,KAAK,GAAG,CAAC,CAAC;IAChB,MAAM,KAAK,GAAG,CAAC,CAAC;IAEhB,aAAa,CAAC,IAAI,CAAC;QACjB,OAAO,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QACzB,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACrB,OAAO,CAAC,SAAS,CAAC,WAAW,EAAE,KAAK,GAAG,EAAE,EAAE,KAAK,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;KAC9E,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC;CACf;AAED;IACE,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,GAAG,SAAS,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IAE5C,MAAM,KAAK,GAAG,CAAC,CAAC;IAChB,MAAM,KAAK,GAAG,CAAC,CAAC;IAEhB,aAAa,CAAC,IAAI,CAAC;;;QAGjB,OAAO,CAAC,SAAS,CAAC,WAAW,EAAE,KAAK,GAAG,EAAE,EAAE,KAAK,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;KAC9E,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC;CACf;AAED;IACE,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,GAAG,SAAS,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IAE5C,MAAM,KAAK,GAAG,CAAC,CAAC;IAChB,MAAM,KAAK,GAAG,CAAC,CAAC;IAEhB,aAAa,CAAC,IAAI,CAAC;;;QAGjB,OAAO,CAAC,SAAS,CAAC,WAAW,EAAE,KAAK,GAAG,EAAE,EAAE,KAAK,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;KAC9E,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC;CACf;AAED,AAAO,MAAM,aAAa,GAAG,iBAAiB,EAAE,CAAC;AACjD,AAAO,MAAM,eAAe,GAAG,mBAAmB,EAAE,CAAC;AACrD,AAAO,MAAM,aAAa,GAAG,iBAAiB,CAAC,QAAQ,CAAC,CAAC;AACzD,AAAO,MAAM,mBAAmB,GAAG,iBAAiB,CAAC,KAAK,CAAC,CAAC;AAC5D,AAAO,MAAM,YAAY,GAAG,gBAAgB,EAAE,CAAC;AAC/C,AAAO,MAAM,eAAe,GAAG,mBAAmB,EAAE,CAAC;AACrD,AAAO,MAAM,iBAAiB,GAAG,qBAAqB,EAAE,CAAC;AACzD,AAAO,MAAM,WAAW,GAAG,eAAe,EAAE,CAAC;AAC7C,AAAO,MAAM,aAAa,GAAG,iBAAiB,EAAE,CAAC;AACjD,AAAO,MAAM,cAAc,GAAG,kBAAkB,EAAE,CAAC;AACnD,AAAO,MAAM,cAAc,GAAG,kBAAkB,EAAE,CAAC;AACnD,AAAO,MAAM,eAAe,GAAG,mBAAmB,EAAE,CAAC;;;AC7MrD,MAAM,MAAM,GAAG;IACb,aAAa;CACd,CAAC;AAEF,MAAM,KAAK,GAAa,EAAE,CAAC;AAE3B,MAAM,KAAK,GAAG;IACZ,WAAW;IACX,YAAY;IACZ,gBAAgB;IAChB,SAAS;IACT,cAAc;IACd,UAAU;IACV,WAAW;CACZ,CAAC;AAIF,MAAM,MAAM,GAAuB,IAAI,GAAG,EAAE,CAAC;AAE7C,iBAAiB,QAAgB;IAC/B,OAAO,UAAU,QAAQ,EAAE,CAAC;CAC7B;AAED,IAAI,OAAO,GAAG,CAAC,CAAC;AAEhB,AAAO,MAAM,YAAY,GAAG,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM;IACtD,MAAM,OAAO,GAAG,CAAC,GAAW,EAAE,MAAa;QACzC,OAAO,EAAE,CAAC;QACV,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;QACxB,IAAI,OAAO,KAAK,CAAC,EAAE;YACjB,OAAO,EAAE,CAAC;SACX;KACF,CAAC;IAEF,MAAM,IAAI,GAAG,CAAC,GAAW,EAAE,GAAmB;QAC5C,OAAO,EAAE,CAAC;QACV,OAAO,CAAC,GAAG,CAAC,iBAAiB,GAAG,KAAK,GAAG,EAAE,CAAC,CAAC;QAC5C,IAAI,OAAO,KAAK,CAAC,EAAE;YACjB,OAAO,EAAE,CAAC;SACX;KACF,CAAC;IAEF,KAAK,MAAM,QAAQ,IAAI,MAAM,EAAE;QAC7B,OAAO,EAAE,CAAC;QACV,MAAM,KAAK,GAAG,IAAI,KAAK,EAAE,CAAC;QAC1B,KAAK,CAAC,GAAG,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;QAC9B,KAAK,CAAC,MAAM,GAAG,MAAM,OAAO,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;QAC9C,KAAK,CAAC,OAAO,GAAG,CAAC,CAAC,KAAK,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC;KAChD;IAED,KAAK,MAAM,QAAQ,IAAI,KAAK,EAAE;QAC5B,OAAO,EAAE,CAAC;QACV,MAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;QAC9C,KAAK,CAAC,GAAG,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;QAC9B,KAAK,CAAC,SAAS,GAAG,MAAM,OAAO,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;QACjD,KAAK,CAAC,OAAO,GAAG,CAAC,CAAC,KAAK,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC;KAChD;IAED,KAAK,MAAM,GAAG,IAAI,KAAK,EAAE;QACvB,OAAO,EAAE,CAAC;QACV,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,KAAK,QAAQ,CAAC,WAAW,EAAE,CAAC;aAC3D,IAAI,CAAC,CAAC,MAAM,KAAK,OAAO,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;aACtC,KAAK,CAAC,CAAC,MAAM,KAAK,IAAI,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC;KACzC;CACF,CAAC,CAAC;;AAIH,kBAAyB,IAAY;IACnC,OAAO,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;CACzB;;;ACpED,MAAM,WAAW,GAAa;IAC5B,OAAO;IACP,QAAQ;IACR,YAAY;IACZ,KAAK;IACL,UAAU;IACV,MAAM;IACN,OAAO;CACR,CAAC;AAEF,MAAM,MAAM,GAA6B,IAAI,GAAG,EAAE,CAAC;AACnD,MAAMA,SAAO,GAAG,IAAI,YAAY,EAAE,CAAC;AAEnC,MAAM,aAAa,GAAGA,SAAO,CAAC,UAAU,EAAE,CAAC;AAC3C,MAAM,aAAa,GAAGA,SAAO,CAAC,UAAU,EAAE,CAAC;AAE3C,aAAa,CAAC,OAAO,CAACA,SAAO,CAAC,WAAW,CAAC,CAAC;AAC3C,aAAa,CAAC,OAAO,CAACA,SAAO,CAAC,WAAW,CAAC,CAAC;AAE3C,YAAY,CAAC,IAAI,CAAC;IAChB,KAAK,MAAM,IAAI,IAAI,WAAW,EAAE;QAC9B,MAAM,IAAI,GAAG,QAAQ,CAAC,GAAG,IAAI,MAAM,CAAgB,CAAC;QACpDA,SAAO,CAAC,eAAe,CAAC,IAAI,EAAE,CAAC,MAAM;YACnC,MAAM,CAAC,GAAG,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;SAC1B,CAAC,CAAC;KACJ;CACF,CAAC,CAAC;AAEH;IACE,IAAI,WAAW;QACb,OAAO,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC;KACjC;IAED,IAAI,WAAW,CAAC,KAAa;QAC3B,KAAK,GAAG,KAAK,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAC3B,aAAa,CAAC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;KAClC;IAED,IAAI,WAAW;QACb,OAAO,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC;KACjC;IAED,IAAI,WAAW,CAAC,KAAa;QAC3B,KAAK,GAAG,KAAK,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAC3B,aAAa,CAAC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;KAClC;IAED,IAAI,CAAC,IAAY;QACf,IAAI,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;YACpB,MAAM,MAAM,GAAGA,SAAO,CAAC,kBAAkB,EAAE,CAAC;YAC5C,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,IAAI,CAAE,CAAC;YAClC,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;YAC9B,MAAM,CAAC,KAAK,EAAE,CAAC;SAChB;KACF;IAED,YAAY,CAAC,KAAuB;QAClC,MAAM,MAAM,GAAGA,SAAO,CAAC,wBAAwB,CAAC,KAAK,CAAC,CAAC;QACvD,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;KAC/B;CACF;AACD,YAAe,IAAI,YAAY,EAAE,CAAC;;;AClDlC,MAAM,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;AACpB,AAEA,IAAK,OAIJ;AAJD,WAAK,OAAO;IACV,mCAAG,CAAA;IACH,yCAAM,CAAA;IACN,2CAAO,CAAA;CACR,EAJI,OAAO,KAAP,OAAO,QAIX;AAED,AAAA,IAAY,MAKX;AALD,WAAY,MAAM;IAChB,mCAAI,CAAA;IACJ,qCAAK,CAAA;IACL,+BAAE,CAAA;IACF,mCAAI,CAAA;CACL,EALW,MAAM,KAAN,MAAM,QAKjB;AAED,IAAK,iBAKJ;AALD,WAAK,iBAAiB;IACpB,6DAAM,CAAA;IACN,yDAAI,CAAA;IACJ,+DAAO,CAAA;IACP,qEAAU,CAAA;CACX,EALI,iBAAiB,KAAjB,iBAAiB,QAKrB;AAEc;IA+Cb,YAAY,IAAgB,EAAE,GAAO,EAAE,UAAkC,EAAE;QA9C3E,QAAG,GAAO,EAAE,CAAC,MAAM,EAAE,CAAC;QACtB,OAAE,GAAO,EAAE,CAAC,MAAM,EAAE,CAAC;QACrB,MAAC,GAAO,EAAE,CAAC,MAAM,EAAE,CAAC;QACpB,OAAE,GAAO,EAAE,CAAC,MAAM,EAAE,CAAC;QACrB,WAAM,GAAG,MAAM,CAAC,KAAK,CAAC;;QAGtB,eAAU,GAAG,IAAI,CAAC;QAClB,aAAQ,GAAG,KAAK,CAAC;QACjB,eAAU,GAAG,KAAK,CAAC;;QAEnB,gBAAW,GAAG,KAAK,CAAC;QACpB,YAAO,GAAG,KAAK,CAAC;QAChB,WAAM,GAAG,KAAK,CAAC;QACf,aAAQ,GAAG,KAAK,CAAC;QACjB,UAAK,GAAG,KAAK,CAAC;QACd,iBAAY,GAAG,KAAK,CAAC;QACrB,gBAAW,GAAG,KAAK,CAAC;QACpB,WAAM,GAAG,KAAK,CAAC;QACf,aAAQ,GAAG,KAAK,CAAC;QACjB,gBAAW,GAAG,KAAK,CAAC;QAEpB,sBAAiB,GAAG,iBAAiB,CAAC,OAAO,CAAC;QAC9C,WAAM,GAAG,CAAC,CAAC;QACX,cAAS,GAAG,GAAG,CAAC;QAChB,UAAK,GAAG,IAAI,CAAC;QACb,aAAQ,GAAG,CAAC,CAAC;QACb,WAAM,GAAG,CAAC,CAAC;QACX,YAAO,GAAG,OAAO,CAAC,GAAG,CAAC;;QAEtB,gBAAW,GAAG,CAAC,CAAC;QAChB,gBAAW,GAAG,GAAG,CAAC;QAClB,WAAM,GAAG,CAAC,CAAC;QACX,WAAM,GAAkB,IAAI,CAAC;QAE7B,cAAS,GAAU,EAAE,CAAC;QACtB,aAAQ,GAAW,CAAC,CAAC;QACrB,SAAI,GAAG,CAAC,CAAC;QACT,YAAO,GAAG,CAAC,CAAC;QACZ,cAAS,GAAG,CAAC,CAAC;QACd,cAAS,GAAG,CAAC,CAAC;QACd,eAAU,GAAe,UAAU,CAAC,GAAG,CAAC;QACxC,mBAAc,GAAG,CAAC,CAAC;QAEnB,YAAO,GAAG,eAAe,CAAC;QAGxB,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;QAExB,QAAQ,IAAI;YACV,KAAK,UAAU,CAAC,MAAM,EAAE;gBACtB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;gBACvB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;gBACrB,IAAI,CAAC,SAAS,GAAG,GAAG,CAAC;gBACrB,IAAI,CAAC,OAAO,GAAG,aAAa,CAAC;gBAC7B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;;gBAElB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC;gBAC9B,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;gBAClB,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;gBACf,MAAM;aACP;YAED,KAAK,UAAU,CAAC,aAAa,EAAE;gBAC7B,IAAI,CAAC,OAAO,GAAG,eAAe,CAAC;gBAC/B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC;gBAC9B,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;gBACjB,IAAI,CAAC,KAAK,GAAG,CAAC,KAAa;oBACzB,gBAAgB,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;oBAC1C,IAAI,CAAC,GAAG,EAAE,CAAC;iBACZ,CAAC;gBACF,MAAM;aACP;YAED,KAAK,UAAU,CAAC,MAAM,EAAE;gBACtB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;gBACrB,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;gBACpB,IAAI,CAAC,OAAO,GAAG,aAAa,CAAC;gBAC7B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;;gBAElB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;gBAClB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;gBACpB,IAAI,CAAC,MAAM,GAAG,GAAG,CAAC;gBAClB,IAAI,CAAC,iBAAiB,GAAG,iBAAiB,CAAC,UAAU,CAAC;gBACtD,MAAM;aACP;YAED,KAAK,UAAU,CAAC,YAAY,EAAE;gBAC5B,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;gBACrB,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;gBACpB,IAAI,CAAC,OAAO,GAAG,mBAAmB,CAAC;gBACnC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;;gBAElB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;gBAClB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;gBACpB,IAAI,CAAC,MAAM,GAAG,GAAG,CAAC;gBAClB,IAAI,CAAC,iBAAiB,GAAG,iBAAiB,CAAC,UAAU,CAAC;gBACtD,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;gBACrB,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC;gBAChB,IAAI,CAAC,OAAO,GAAG,GAAG,CAAC;gBACnB,IAAI,CAAC,SAAS,GAAG,GAAG,CAAC;gBACrB,MAAM;aACP;YAED,KAAK,UAAU,CAAC,MAAM,EAAE;gBACtB,IAAI,CAAC,OAAO,GAAG,aAAa,CAAC;gBAC7B,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;gBACpB,IAAI,CAAC,MAAM,GAAG,GAAG,CAAC;gBAClB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;gBACnB,MAAM;aACP;YAED,KAAK,UAAU,CAAC,UAAU,EAAE;gBAC1B,IAAI,CAAC,OAAO,GAAG,iBAAiB,CAAC;gBACjC,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,IAAI,OAAO,CAAC,GAAG,CAAC;gBAC9C,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,IAAI,MAAM,CAAC,IAAI,CAAC;gBAC5C,QAAQ,IAAI,CAAC,MAAM;oBACjB,KAAK,MAAM,CAAC,IAAI,EAAE;wBAChB,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;wBACzB,MAAM;qBACP;oBACD,KAAK,MAAM,CAAC,KAAK,EAAE;wBACjB,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;wBACxB,MAAM;qBACP;oBACD,KAAK,MAAM,CAAC,EAAE,EAAE;wBACd,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;wBACxB,MAAM;qBACP;oBACD,KAAK,MAAM,CAAC,IAAI,EAAE;wBAChB,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;wBACzB,MAAM;qBACP;iBACF;gBACD,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;gBAChB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;gBACxB,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;gBAClB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;gBACpB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;gBACjB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;gBACnB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;gBACzB,MAAM;aACP;YAED,KAAK,UAAU,CAAC,KAAK,EAAE;gBACrB,IAAI,CAAC,OAAO,GAAG,YAAY,CAAC;gBAC5B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC;gBAC9B,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;gBACjB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;gBACxB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;gBACjB,MAAM;aACP;YAED,KAAK,UAAU,CAAC,OAAO,EAAE;gBACvB,IAAI,CAAC,OAAO,GAAG,cAAc,CAAC;gBAC9B,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;gBAChB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,IAAI,OAAO,CAAC,GAAG,CAAC;gBAC9C,IAAI,CAAC,cAAc,GAAG,CAAC,CAAC;gBACxB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;gBACrB,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,IAAI,MAAM,CAAC,IAAI,CAAC;gBAC5C,QAAQ,IAAI,CAAC,MAAM;oBACjB,KAAK,MAAM,CAAC,IAAI,EAAE;wBAChB,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;wBAC1B,MAAM;qBACP;oBACD,KAAK,MAAM,CAAC,KAAK,EAAE;wBACjB,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;wBACzB,MAAM;qBACP;oBACD,KAAK,MAAM,CAAC,EAAE,EAAE;wBACd,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC;wBACvB,MAAM;qBACP;oBACD,KAAK,MAAM,CAAC,IAAI,EAAE;wBAChB,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;wBACxB,MAAM;qBACP;iBACF;gBACD,MAAM;aACP;YAED,KAAK,UAAU,CAAC,SAAS,EAAE;gBACzB,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;gBAChB,IAAI,CAAC,MAAM,GAAG,GAAG,CAAC;gBAClB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;gBAC/B,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;gBACpB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;gBACxB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;gBACnB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;gBACxB,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;gBAClB,MAAM;aACP;YAED,KAAK,UAAU,CAAC,IAAI,EAAE;gBACpB,IAAI,CAAC,OAAO,GAAG,WAAW,CAAC;gBAC3B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC;gBAC9B,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;gBACjB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;gBACnB,IAAI,CAAC,KAAK,GAAG;oBACX,IAAI,KAAK,CAAC,aAAa,KAAK,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE;wBACnD,SAAS,EAAE,CAAC;qBACb;yBAAM;wBACL,IAAI,IAAI,CAAC,QAAQ,KAAK,CAAC,EAAE;4BACvB,SAAS,CAAC,yBAAyB,EAAE,EAAE,CAAC,CAAC;4BACzC,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;4BACrB,IAAI,CAAC,QAAQ,IAAI,GAAG,CAAC;yBACtB;qBACF;iBACF,CAAC;gBACF,MAAM;aACP;YAED,KAAK,UAAU,CAAC,QAAQ,EAAE;gBACxB,IAAI,CAAC,OAAO,GAAG,eAAe,CAAC;gBAC/B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC;gBAC9B,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;gBACjB,IAAI,CAAC,KAAK,GAAG,CAAC,MAAc;;;oBAG1B,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;oBAC1B,SAAS,EAAE,CAAC;oBACZ,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;oBACpB,IAAI,CAAC,GAAG,EAAE,CAAC;iBACZ,CAAC;gBACF,MAAM;aACP;SACF;QAED,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC;SAC9B;KACF;IAED,MAAM,CAAC,EAAU;QACf,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAEtB,IAAI,IAAI,CAAC,WAAW,GAAG,CAAC,EAAE;YACxB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC,CAAC;SACvD;QAED,IAAI,IAAI,CAAC,QAAQ,GAAG,CAAC,EAAE;YACrB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC,CAAC;SACjD;QAED,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,QAAQ,IAAI,EAAE,CAAC;SACrB;QAED,IAAI,IAAI,CAAC,QAAQ,GAAG,CAAC,EAAE;YACrB,OAAO,IAAI,CAAC,GAAG,EAAE,CAAC;SACnB;QAED,IAAI,IAAI,CAAC,MAAM,IAAI,CAAC,IAAI,IAAI,CAAC,QAAQ,EAAE;YACrC,IAAI,OAAO,CAAC,MAAM,IAAI,IAAI,KAAK,MAAM,EAAE;gBACrC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;gBACnB,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;gBACf,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;aAClB;iBAAM;gBACL,OAAO,IAAI,CAAC,GAAG,EAAE,CAAC;aACnB;SACF;QAED,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,cAAc,IAAI,EAAE,CAAC;YAC1B,IAAI,IAAI,CAAC,cAAc,GAAG,CAAC,EAAE;gBAC3B,QAAQ,CAAC,GAAG,CAAC,IAAI,MAAM,CAAC,UAAU,CAAC,SAAS,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;gBACzD,IAAI,CAAC,GAAG,EAAE,CAAC;aACZ;SACF;QAED,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,QAAQ,EAAE,GAAG,CAAC,GAAG,EAAE,CAAC;SACrD;QAED,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,KAAK,GAAG,IAAI,EAAE;YACpC,IAAI,CAAC,KAAK,IAAI,GAAG,GAAG,EAAE,CAAC;SACxB;QAED,IAAI,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,OAAO,EAAE;YAC9B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;SAC9C;aAAM,IAAI,IAAI,CAAC,SAAS,GAAG,CAAC,EAAE;YAC7B,IAAI,CAAC,SAAS,IAAI,EAAE,CAAC;SACtB;QAED,IAAI,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,SAAS,IAAI,CAAC,EAAE;YACnD,IAAI,CAAC,IAAI,EAAE,CAAC;YACZ,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC;YACjC,IAAI,OAAO,CAAC,SAAS,EAAE;gBACrB,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC;aAClC;SACF;QAED,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;SACxB;aAAM;YACL,IAAI,IAAI,CAAC,KAAK,EAAE;gBACd,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,KAAK,MAAM,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;aACnD;YACD,IAAI,IAAI,CAAC,MAAM,EAAE;gBACf,MAAM,IAAI,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC;gBACzB,EAAE,CAAC,GAAG,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC;gBACxC,MAAM,SAAS,GAAG,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBAEjC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC;gBAE5E,IAAI,IAAI,CAAC,WAAW,IAAI,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE;oBACvC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;iBACzB;gBAED,EAAE,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;gBACzB,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;aACzB;SACF;QAED,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;QAErC,IAAI,OAAO,CAAC,YAAY,IAAI,IAAI,CAAC,OAAO,KAAK,OAAO,CAAC,GAAG,EAAE;YACxD,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;SAC7B;QACD,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;SAC/B;QAED,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;YAClC,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;SAC/B;;QAGD,MAAM,OAAO,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC;QAC5B,EAAE,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QACjD,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;QAElC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;YAChB,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;SAC7B;QAED,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;;;QAG7B,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;;QAEhC,MAAM,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC;QACvB,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QACvB,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,GAAG,GAAG,EAAE,CAAC,CAAC;QACnC,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;QAE7B,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;QACtB,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,QAAQ,GAAG,CAAC,CAAC;YACjB,OAAO,QAAQ,EAAE,EAAE;gBACjB,MAAM,SAAS,GAAG,KAAK,CAAC,GAAG,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;gBAChD,IAAI,SAAS,CAAC,IAAI,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE;oBACtD,IAAI,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,GAAG,EAAE;wBAC7B,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;qBACtB;oBAED,IAAI,QAAQ,KAAK,CAAC,EAAE;wBAClB,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;qBACvB;yBAAM;wBACL,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,MAAM,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC;qBACnD;oBACD,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;iBACpB;aACF;SACF;QAED,KAAK,MAAM,KAAK,IAAI,QAAQ,EAAE;YAC5B,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,CAAC,UAAU,IAAI,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE;gBACjE,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;gBACpB,KAAK,CAAC,GAAG,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;;;;;aAKrB;SACF;QAED,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE;YACnB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC;SAC1D;QAED,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;KACrC;IAED,KAAK,CAAC,MAAc;QAClB,IAAI,IAAI,CAAC,WAAW,KAAK,CAAC,IAAI,IAAI,CAAC,IAAI,GAAG,CAAC,EAAE;YAC3C,IAAI,IAAI,CAAC,UAAU,KAAK,UAAU,CAAC,GAAG,EAAE;gBACtC,QAAQ,CAAC,GAAG,CAAC,IAAI,MAAM,CAAC,UAAU,CAAC,UAAU,EAAE,IAAI,CAAC,GAAG,EAAE,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;gBAC7F,IAAI,CAAC,IAAI,EAAE,CAAC;aACb;iBAAM,IAAI,IAAI,CAAC,UAAU,KAAK,UAAU,CAAC,OAAO,EAAE;gBACjD,QAAQ,CAAC,GAAG,CAAC,IAAI,MAAM,CAAC,UAAU,CAAC,OAAO,EAAE,IAAI,CAAC,GAAG,EAAE,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;gBAC1F,IAAI,CAAC,IAAI,IAAI,EAAE,CAAC;aACjB;YACD,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAClB,IAAI,CAAC,WAAW,IAAI,GAAG,CAAC;SACzB;KACF;IAED,aAAa,CAAC,EAAU;QACtB,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QACtB,IAAI,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,QAAQ,EAAE;YAClD,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC;YACjB,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACrB;;;;QAID,IAAI,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;YAC7B,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;SACjB;QACD,IAAI,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;YAC7B,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;SAChB;QAED,IAAI,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;YAC9B,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;SACvB;QACD,IAAI,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;YAChC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;SACzB;QACD,IAAI,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;YAChC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;SACzB;QACD,IAAI,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;YACjC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;SAC1B;QAED,IAAI,gBAAgB,CAAC,QAAQ,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE;YAC5E,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC,GAAG,CAAC;SAClC;QACD,IAAI,gBAAgB,CAAC,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE;YAChF,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC,OAAO,CAAC;SACtC;QAED,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;KAChC;IAED,gBAAgB,CAAC,SAAa;QAC5B,MAAM,MAAM,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC;QAC3B,EAAE,CAAC,SAAS,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;QACnC,EAAE,CAAC,GAAG,CAAC,MAAM,EAAE,SAAS,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;QACvC,EAAE,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;QACjC,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE;YACvB,MAAM,KAAK,GAAG,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;YACzC,IAAI,KAAK,GAAG,CAAC,EAAE;gBACb,EAAE,CAAC,GAAG,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;aACjC;SACF;QACD,OAAO,MAAM,CAAC;KACf;IAED,WAAW,CAAC,KAAa;;QAEvB,MAAM,OAAO,GAAG,IAAI,CAAC,gBAAgB,CAAC;QACtC,OAAO,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;KAC3D;IAED,UAAU,CAAC,MAAU,EAAE,UAAkB;QACvC,IAAI,YAAY,GAAG,CAAC,GAAG,UAAU,CAAC;QAClC,IAAI,IAAI,CAAC,iBAAiB,KAAK,iBAAiB,CAAC,MAAM,EAAE;YACvD,YAAY,IAAI,GAAG,CAAC;SACrB;QAED,QAAQ,IAAI,CAAC,iBAAiB;YAC5B,KAAK,iBAAiB,CAAC,UAAU,EAAE;gBACjC,IAAI,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE;oBACpB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,KAAK,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC;iBACxE;aACF;YACD,KAAK,iBAAiB,CAAC,MAAM,CAAC;YAC9B,KAAK,iBAAiB,CAAC,OAAO,EAAE;gBAC9B,MAAM,KAAK,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC;gBAC1B,MAAM,MAAM,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC;gBAE3B,EAAE,CAAC,GAAG,CAAC,MAAM,EAAE,MAAM,EAAE,YAAY,GAAG,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,CAAC;gBAC/D,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;gBAEjC,EAAE,CAAC,GAAG,CAAC,KAAK,EAAE,MAAM,EAAE,YAAY,GAAG,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC;gBAC7D,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;gBAC9B,MAAM;aACP;YAED,KAAK,iBAAiB,CAAC,IAAI,EAAE;gBAC3B,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;gBACtB,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;gBACrB,MAAM;aACP;SACF;KACF;;;;IAKD,GAAG,CAAC,KAAoB,EAAE,EAAU;QAClC,IAAI,CAAC,KAAK,EAAE;YACV,IAAI,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrC,IAAI,CAAC,GAAG,EAAE,CAAC;aACZ;YACD,OAAO;SACR;QAED,IAAI,IAAI,CAAC,KAAK,IAAI,KAAK,KAAK,MAAM,EAAE;YAClC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;SACnB;QAED,IAAI,IAAI,CAAC,QAAQ,IAAI,KAAK,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,KAAK,KAAK,CAAC,OAAO,EAAE;YACpE,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;YAC1B,IAAI,IAAI,KAAK,MAAM,IAAI,OAAO,CAAC,YAAY,EAAE;gBAC3C,MAAM,IAAI,CAAC,CAAC;aACb;YACD,IAAI,KAAK,CAAC,YAAY,EAAE;gBACtB,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC;gBACtB,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBACnB,KAAK,CAAC,GAAG,EAAE,CAAC;aACb;iBAAM;gBACL,IAAI,KAAK,CAAC,QAAQ,KAAK,CAAC,EAAE;oBACxB,IAAI,CAAC,MAAM,IAAI,MAAM,GAAG,IAAI,CAAC;oBAC7B,KAAK,CAAC,QAAQ,IAAI,IAAI,CAAC;oBACvB,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;iBACpB;aACF;SACF;QAED,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,OAAO,KAAK,KAAK,CAAC,OAAO,EAAE;YACtD,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC,SAAS,EAAE;gBACrD,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;oBACnB,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,EAAE,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC;iBACtE;gBACD,OAAO,IAAI,CAAC,GAAG,EAAE,CAAC;aACnB;SACF;KACF;IAED,GAAG;QACD,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAEtB,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SACxB;QAED,IAAI,IAAI,KAAK,MAAM,EAAE;YACnB,KAAK,EAAE,CAAC;SACT;KACF;CACF;;AClhBD,IAAI,cAAc,GAAW,CAAC,CAAC;AAC/B,IAAI,SAAS,GAAG,KAAK,CAAC;AAEtB;IACE,IAAI,cAAc,KAAK,CAAC,EAAE;QACxB,cAAc,GAAG,WAAW,CAAC,GAAG,EAAE,CAAC;KACpC;IAED,MAAM,UAAU,GAAG,WAAW,CAAC,GAAG,EAAE,CAAC;IACrC,MAAM,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,UAAU,GAAG,cAAc,IAAI,IAAI,EAAE,GAAG,CAAC,CAAC;IAC/D,cAAc,GAAG,UAAU,CAAC;IAE5B,IAAI,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;QAC7B,IAAI,CAAC,SAAS,EAAE;YACd,WAAW,EAAE,CAAC;SACf;QACD,SAAS,GAAG,IAAI,CAAC;KAClB;SAAM;QACL,SAAS,GAAG,KAAK,CAAC;KACnB;IAED,OAAO,CAAC,IAAI,EAAE,CAAC;IAEf,OAAO,CAAC,SAAS,GAAG,kBAAkB,CAAC;IACvC,OAAO,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC;IAEpD,OAAO,CAAC,SAAS,EAAE,MAAM,CAAC,KAAK,GAAG,CAAC,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;IAC3D,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACrB,OAAO,CAAC,SAAS,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAElD,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAExB,IAAI,CAAC,MAAM,EAAE;QACX,KAAK,MAAM,MAAM,IAAI,QAAQ,EAAE;YAC7B,MAAM,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;SACnB;QAED,IAAI,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;YACrB,MAAM,CAAC,GAAG,EAAE,CAAC;SACd;KACF;IAED,KAAK,MAAM,MAAM,IAAI,QAAQ,EAAE;QAC7B,OAAO,CAAC,IAAI,EAAE,CAAC;QACf,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAChD,IAAI,MAAM,CAAC,QAAQ,IAAI,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,SAAS,IAAI,MAAM,KAAK,MAAM,EAAE;YAC5E,OAAO,CAAC,SAAS,GAAG,KAAK,CAAC;YAC1B,OAAO,CAAC,QAAQ,CAAC,CAAC,EAAE,EAAE,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE,EAAE,IAAI,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC;SACtF;QACD,IAAI,MAAM,CAAC,MAAM,KAAK,MAAM,CAAC,IAAI,EAAE;YACjC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;SACtB;QACD,IAAI,MAAM,CAAC,WAAW,EAAE;YACtB,OAAO,CAAC,SAAS,GAAG,QAAQ,CAAC;YAC7B,OAAO,CAAC,SAAS,EAAE,CAAC;YACpB,OAAO,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;YACjD,OAAO,CAAC,IAAI,EAAE,CAAC;SAChB;aAAM;YACL,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,GAAG,CAAC,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;SAC1F;QACD,OAAO,CAAC,OAAO,EAAE,CAAC;KACnB;IAED,OAAO,CAAC,OAAO,EAAE,CAAC;IAElB,aAAa,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;IAC3B,UAAU,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;IAExB,OAAO,EAAE,CAAC;IAEV,qBAAqB,CAAC,IAAI,CAAC,CAAC;CAC7B;AAED,MAAM,cAAc,GAAG,OAAO,CAAC,oBAAoB,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;AACnE,cAAc,CAAC,YAAY,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC;AACjD,cAAc,CAAC,YAAY,CAAC,CAAC,EAAE,kBAAkB,CAAC,CAAC;AAEnD;IACE,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC;IAC9B,OAAO,CAAC,SAAS,GAAG,cAAc,CAAC;IACnC,OAAO,CAAC,QAAQ,CAAC,EAAE,EAAE,EAAE,EAAE,GAAG,GAAG,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC;IACrE,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;IAEpC,OAAO,CAAC,IAAI,GAAG,uCAAuC,CAAC;IACvD,OAAO,CAAC,SAAS,GAAG,OAAO,CAAC;IAC5B,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC;IAC9B,OAAO,CAAC,YAAY,GAAG,KAAK,CAAC;IAC7B,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;IAC/C,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;IAEjD,IAAI,aAAa,GAAG,CAAC,CAAC;IAEtB,IAAI,gBAAgB,CAAC,QAAQ,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;QAC7C,OAAO,CAAC,QAAQ,CAAC,GAAG,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,GAAG,aAAa,CAAC,CAAC,CAAC;QACrD,OAAO,CAAC,SAAS,CAAC,cAAc,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,GAAG,aAAa,CAAC,CAAC,CAAC;QACjE,IAAI,MAAM,CAAC,UAAU,KAAK,UAAU,CAAC,GAAG,EAAE;YACxC,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC;YAC9B,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,GAAG,aAAa,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;SAC3D;QACD,aAAa,EAAE,CAAC;KACjB;IAED,IAAI,gBAAgB,CAAC,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE;QACjD,OAAO,CAAC,QAAQ,CAAC,GAAG,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,GAAG,aAAa,CAAC,CAAC,CAAC;QACrD,OAAO,CAAC,SAAS,CAAC,eAAe,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,GAAG,aAAa,CAAC,CAAC,CAAC;QAClE,IAAI,MAAM,CAAC,UAAU,KAAK,UAAU,CAAC,OAAO,EAAE;YAC5C,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC;YAC9B,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,GAAG,aAAa,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;SAC3D;QACD,aAAa,EAAE,CAAC;KACjB;CACF;AAED;IACE,KAAK,EAAE,CAAC;IACR,qBAAqB,CAAC,IAAI,CAAC,CAAC;CAC7B;AAED,MAAM,YAAY,GAAG,IAAI,KAAK,EAAE,CAAC;AACjC,YAAY,CAAC,GAAG,GAAG,oBAAoB,CAAC;AACxC,YAAY,CAAC,MAAM,GAAG;IACpB,OAAO,CAAC,SAAS,CAAC,YAAY,EAAE,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,KAAK,GAAG,CAAC,EAAE,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IAC3E,UAAU,CAAC;QACT,OAAO,CAAC,GAAG,CAAC,CAAC,YAAY,EAAE,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KACvD,EAAE,IAAI,CAAC,CAAC;CACV,CAAC;"}