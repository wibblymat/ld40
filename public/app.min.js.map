{"version":3,"file":"app.min.js","sources":["../src/banner.ts","../src/utils.ts","../src/display.ts","../src/controls.ts","../src/maths.ts","../src/collision.ts","../src/entityType.ts","../src/worldMap.ts","../src/levels.ts","../src/gameState.ts","../src/graphic.ts","../src/assets.ts","../src/sound.ts","../src/entity.ts","../src/index.ts"],"sourcesContent":["const bannerQueue: Array<{ text: string, size: number }> = [];\nconst topBannerQueue: Array<{ text: string, size: number }> = [];\n\nexport function addBanner(text: string, size: number) {\n  if (currentBanner === text) {\n    return;\n  }\n  for (const banner of bannerQueue) {\n    if (text === banner.text) {\n      return;\n    }\n  }\n  bannerQueue.push({ text, size });\n}\n\nexport function addTopBanner(text: string, size: number) {\n  if (currentTopBanner === text) {\n    return;\n  }\n  for (const banner of topBannerQueue) {\n    if (text === banner.text) {\n      return;\n    }\n  }\n  topBannerQueue.push({ text, size });\n}\n\nlet currentTimer = 0;\nlet currentBanner: string = '';\nlet currentSize = 20;\nconst MAX_TIME = 3;\n\nlet currentTopTimer = 0;\nlet currentTopBanner: string = '';\nlet currentTopSize = 80;\nconst MAX_TOP_TIME = 3;\n\nexport function drawBanner(context: CanvasRenderingContext2D, dT: number) {\n  if (currentTimer <= 0 && bannerQueue.length > 0) {\n    currentTimer = MAX_TIME;\n    const details = bannerQueue.shift()!;\n    currentBanner = details.text;\n    currentSize = details.size;\n  }\n\n  if (currentTimer > 0) {\n    currentTimer -= dT;\n  } else {\n    currentBanner = '';\n    return;\n  }\n\n  context.save();\n  if (currentTimer > 2.5) {\n    context.globalAlpha = 1 - ((currentTimer - 2.5) * 2);\n  }\n  if (currentTimer < 0.5) {\n    context.globalAlpha = Math.max(0, currentTimer * 2);\n  }\n  context.font = `${currentSize}px \"Bungee\", Arial, sans-serif`;\n  context.textBaseline = 'middle';\n  context.fillStyle = 'white';\n  context.strokeStyle = 'black';\n  context.lineWidth = Math.max(1, currentSize / 20);\n  context.shadowOffsetX = Math.max(1, currentSize / 8);\n  context.shadowOffsetY = Math.max(1, currentSize / 8);\n\n  const width = context.measureText(currentBanner).width;\n\n  context.fillText(currentBanner, context.canvas.width / 4 - width / 2, context.canvas.height / 4 + 100);\n  context.strokeText(currentBanner, context.canvas.width / 4 - width / 2, context.canvas.height / 4 + 100);\n  context.restore();\n}\n\nexport function drawTopBanner(context: CanvasRenderingContext2D, dT: number) {\n  if (currentTopTimer <= 0 && topBannerQueue.length > 0) {\n    currentTopTimer = MAX_TOP_TIME;\n    const details = topBannerQueue.shift()!;\n    currentTopBanner = details.text;\n    currentTopSize = details.size;\n  }\n\n  if (currentTopTimer > 0) {\n    currentTopTimer -= dT;\n  } else {\n    currentTopBanner = '';\n    return;\n  }\n\n  context.save();\n  if (currentTopTimer > 2.5) {\n    context.globalAlpha = 1 - ((currentTopTimer - 2.5) * 2);\n  }\n  if (currentTopTimer < 0.5) {\n    context.globalAlpha = Math.max(0, currentTopTimer * 2);\n  }\n  context.font = `${currentTopSize}px \"Bungee\", Arial, sans-serif`;\n  context.textBaseline = 'middle';\n  context.fillStyle = 'white';\n  context.strokeStyle = 'black';\n  context.lineWidth = Math.max(1, currentTopSize / 20);\n  context.shadowOffsetX = Math.max(1, currentTopSize / 8);\n  context.shadowOffsetY = Math.max(1, currentTopSize / 8);\n\n  const width = context.measureText(currentTopBanner).width;\n\n  context.fillText(currentTopBanner, context.canvas.width / 4 - width / 2, context.canvas.height / 4 - 100);\n  context.strokeText(currentTopBanner, context.canvas.width / 4 - width / 2, context.canvas.height / 4 - 100);\n  context.restore();\n}\n","export function err(): never {\n  throw new Error('Something went wrong!');\n}\n\n/**\n * inputs and outputs are [0, 1], except h.\n */\nexport function hsvToRgb(h: number, s: number, v: number) {\n  if (s === 0) {\n    return [v, v, v];\n  }\n  if (h >= 360) {\n    h = 0;\n  }\n  h /= 60;\n\n  const i = Math.floor(h);\n  const ff = h - i;\n  const p = v * (1 - s);\n  const q = v * (1 - (s * ff));\n  const t = v * (1 - (s * (1 - ff)));\n\n  switch (i) {\n    case 0:\n      return [v, t, p];\n    case 1:\n      return [q, v, p];\n    case 2:\n      return [p, v, t];\n    case 3:\n      return [p, q, v];\n    case 4:\n      return [t, p, v];\n    case 5:\n    default:\n      return [v, p, q];\n  }\n}\n\nexport function clamp(value: number, min: number, max: number): number {\n  return Math.max(min, Math.min(max, value));\n}\n","import { err } from './utils';\n\nexport const canvas = document.getElementById('canvas')! as HTMLCanvasElement;\nexport const context = canvas.getContext('2d') || err();\n\ncanvas.width = 1920;\ncanvas.height = 1080;\nconst targetAspect = canvas.width / canvas.height;\n// context.imageSmoothingEnabled = false;\ncontext.scale(2, 2);\n\nfunction resize() {\n  const aspect = window.innerWidth / window.innerHeight;\n  if (aspect > targetAspect) {\n    canvas.style.height = window.innerHeight + 'px';\n    canvas.style.width = (window.innerWidth * targetAspect / aspect) + 'px';\n  } else {\n    canvas.style.width = window.innerWidth + 'px';\n    canvas.style.height = (window.innerHeight * aspect / targetAspect) + 'px';\n  }\n}\n\nresize();\nwindow.addEventListener('resize', resize);\nwindow.addEventListener('click', () => {\n  canvas.webkitRequestFullscreen();\n});\n\ndocument.body.appendChild(canvas);\n","import { canvas } from './display';\n\nexport enum Key {\n  Space = 32,\n\n  Left = 37,\n  Up = 38,\n  Right = 39,\n  Down = 40,\n\n  One = 49,\n  Two = 50,\n\n  A = 65,\n  D = 68,\n  P = 80,\n  S = 83,\n  W = 87,\n}\n\nconst keystate: { [key: number]: boolean } = {};\n\nconst controls = {\n  isPressed(key: number) {\n    return keystate[key];\n  },\n};\n\nfunction keydown(e: KeyboardEvent) {\n  keystate[e.keyCode] = true;\n  if (!document.webkitFullscreenElement) {\n    canvas.webkitRequestFullscreen();\n  }\n}\n\nfunction keyup(e: KeyboardEvent) {\n  keystate[e.keyCode] = false;\n}\n\ndocument.addEventListener('keydown', keydown);\ndocument.addEventListener('keyup', keyup);\n\nexport default controls;\n","export type V2 = number[] | Float32Array | Float64Array;\n\nexport const v2 = {\n  create(x = 0, y = 0): V2 {\n    return [x, y];\n  },\n\n  set(result: V2, x = 0, y = 0) {\n    result[0] = x;\n    result[1] = y;\n  },\n\n  clone(result: V2, a: V2) {\n    result[0] = a[0];\n    result[1] = a[1];\n  },\n\n  isZero(a: V2): boolean {\n    return a[0] === 0 && a[1] === 0;\n  },\n\n  normalise(result: V2, a: V2) {\n    if (!v2.isZero(a)) {\n      const length = v2.length(a);\n      result[0] = a[0] / length;\n      result[1] = a[1] / length;\n    }\n  },\n\n  lengthSquared(a: V2): number {\n    return a[0] ** 2 + a[1] ** 2;\n  },\n\n  length(a: V2): number {\n    return Math.sqrt(v2.lengthSquared(a));\n  },\n\n  distanceSquared(a: V2, b: V2) {\n    return (a[0] - b[0]) ** 2 + (a[1] - b[1]) ** 2;\n  },\n\n  distance(a: V2, b: V2) {\n    return Math.sqrt(this.distanceSquared(a, b));\n  },\n\n  angle(a: V2): number {\n    return Math.atan2(a[1], a[0]);\n  },\n\n  add(result: V2, a: V2, b: V2) {\n    result[0] = a[0] + b[0];\n    result[1] = a[1] + b[1];\n  },\n\n  sub(result: V2, a: V2, b: V2) {\n    result[0] = a[0] - b[0];\n    result[1] = a[1] - b[1];\n  },\n\n  mul(result: V2, a: V2, scalar: number) {\n    result[0] = a[0] * scalar;\n    result[1] = a[1] * scalar;\n  },\n\n  rotate(result: V2, a: V2, angle: number) {\n    const s = Math.sin(angle);\n    const c = Math.cos(angle);\n    const x = a[0];\n    const y = a[1];\n\n    result[0] = c * x - s * y;\n    result[1] = s * x + c * y;\n  },\n\n  invert(result: V2, a: V2) {\n    result[0] = -a[0];\n    result[1] = -a[1];\n  },\n\n  dot(a: V2, b: V2): number {\n    return a[0] * b[0] + a[1] * b[1];\n  },\n};\n","// GJK/Mikowski collision\nimport { v2, V2 } from './maths';\n\nexport type SupportFunction = (direction: V2) => V2;\n\nconst ao = v2.create();\nconst ab = v2.create();\nconst ac = v2.create();\n\nfunction update(simplex: V2[], direction: V2): boolean {\n  const last: V2 = simplex[simplex.length - 1];\n  const n = simplex.length;\n  if (n === 1) {\n    direction[0] = -last[0];\n    direction[1] = -last[1];\n    return false;\n  }\n  v2.invert(ao, last);\n  v2.sub(ab, simplex[0], last);\n\n  if (n === 2) {\n    direction[0] = -ab[1];\n    direction[1] = ab[0];\n\n    if (v2.dot(direction, ao) < 0) {\n      direction[0] = -direction[0];\n      direction[1] = -direction[1];\n    }\n\n    return false;\n  }\n\n  if (n === 3) {\n    direction[0] = -ab[1];\n    direction[1] = ab[0];\n\n    if (v2.dot(direction, simplex[1]) > 0) {\n      direction[0] = -direction[0];\n      direction[1] = -direction[1];\n    }\n\n    if (v2.dot(direction, ao) > 0) {\n      simplex[1] = simplex[2];\n      const old = simplex.pop()!;\n\n      return false;\n    }\n\n    v2.sub(ac, simplex[1], last);\n    direction[0] = -ac[1];\n    direction[1] = ac[0];\n\n    if (v2.dot(direction, simplex[0]) > 0) {\n      direction[0] = -direction[0];\n      direction[1] = -direction[1];\n    }\n\n    if (v2.dot(direction, ao) > 0) {\n      simplex.shift();\n      return false;\n    }\n\n    return true;\n  }\n  return false;\n}\n\nconst inverseDirection = v2.create();\n\nexport function combineSupport(support1: SupportFunction, support2: SupportFunction): SupportFunction {\n  // TODO: cache these functions\n  return (direction: V2): V2 => {\n    v2.invert(inverseDirection, direction);\n    const s1 = support1(direction);\n    const s2 = support2(inverseDirection);\n    v2.sub(s1, s1, s2);\n    return s1;\n  };\n}\n\nexport function intersect(support1: SupportFunction, support2: SupportFunction): boolean {\n  return intersection(combineSupport(support1, support2));\n}\n\nfunction intersection(support: SupportFunction): boolean {\n  const simplex: V2[] = [];\n  const direction = v2.create(1, 0);\n  while (true) {\n    const a = support(direction);\n    if (v2.dot(a, direction) < 0) {\n      return false;\n    }\n\n    simplex.push(a);\n\n    if (update(simplex, direction)) {\n      return true;\n    }\n  }\n}\n","export enum EntityType {\n  Player,\n  Heart,\n  Mcguffin,\n  Goblin,\n  GoblinArcher,\n  Projectile,\n  Exit,\n  Spikes,\n  Grenade,\n  Explosion,\n  GrenadePickup,\n  Floater,\n}\n","import { intersect } from './collision';\nimport Entity from './entity';\nimport { V2, v2 } from './maths';\nimport { IObjectLayerData, ITileData, ITileLayerData } from './tileData';\nimport { hsvToRgb } from './utils';\n\nconst TILE_SIZE = 32;\n\nconst tileColors: Array<{ light: string, dark: string }> = [];\n\nconst s = 1;\nconst highV = 0.8;\nconst lowV = 0.5;\nfor (let i = 0; i < 16; i++) {\n  const h = (360 / 16) * i;\n  const [r, g, b] = hsvToRgb(h, s, highV);\n  const [dr, dg, db] = hsvToRgb(h, s, lowV);\n  tileColors[i] = {\n    dark: `rgb(${Math.floor(dr * 256)}, ${Math.floor(dg * 256)}, ${Math.floor(db * 256)}`,\n    light: `rgb(${Math.floor(r * 256)}, ${Math.floor(g * 256)}, ${Math.floor(b * 256)}`,\n  };\n}\n\nexport default class WorldMap {\n  objectLayers: IObjectLayerData[] = [];\n  width: number;\n  height: number;\n\n  private data: ITileData;\n  private tileLayers: ITileLayerData[] = [];\n\n  constructor(data: ITileData) {\n    this.data = data;\n\n    for (const layer of data.layers) {\n      if (layer.type === 'tilelayer') {\n        const tileLayer = layer as ITileLayerData;\n        this.tileLayers.push(tileLayer);\n        this.width = tileLayer.width;\n        this.height = tileLayer.height;\n        for (let i = 0; i < tileLayer.data.length; i++) {\n          if (tileLayer.data[i] !== 0) {\n            // tileLayer.data[i] = Math.floor(Math.random() * 15) + 1;\n            tileLayer.data[i] = (i % 15) + 1;\n          }\n        }\n      } else if (layer.type === 'objectgroup') {\n        const objectLayer = layer as IObjectLayerData;\n        this.objectLayers.push(objectLayer);\n      }\n    }\n  }\n\n  getTileIndex(x: number, y: number) {\n    return ((this.height - y - 1) * this.width) + x;\n  }\n\n  translateObjectPosition(x: number, y: number): V2 {\n    return [x, (this.height * TILE_SIZE) + 31 - y];\n  }\n\n  willCollide(entity: Entity, tileX: number, tileY: number) {\n    const entitySupport = entity.collisionSupport.bind(entity);\n    const tileSupport = (direction: V2) => {\n      const result = v2.create(tileX * TILE_SIZE, tileY * TILE_SIZE);\n      if (direction[0] > 0) {\n        result[0] += TILE_SIZE;\n      }\n      if (direction[1] > 0) {\n        result[1] += TILE_SIZE;\n      }\n      return result;\n    };\n    return intersect(entitySupport, tileSupport);\n  }\n\n  findCollision(entity: Entity): {time: number, normal: V2} {\n    const minX = Math.min(entity.dP[0], 0) + entity.pos[0] - entity.radius;\n    const minY = Math.min(entity.dP[1], 0) + entity.pos[1] - entity.radius;\n    const maxX = Math.max(entity.dP[0], 0) + entity.pos[0] + entity.radius;\n    const maxY = Math.max(entity.dP[1], 0) + entity.pos[1] + entity.radius;\n\n    const minTileX = Math.max(0, Math.floor(minX / TILE_SIZE));\n    const minTileY = Math.max(0, Math.floor(minY / TILE_SIZE));\n    const maxTileX = Math.floor(maxX / TILE_SIZE);\n    const maxTileY = Math.floor(maxY / TILE_SIZE);\n\n    const currentTileX = Math.floor(entity.pos[0] / TILE_SIZE);\n    const currentTileY = Math.floor(entity.pos[1] / TILE_SIZE);\n\n    const normal = [0, 0];\n    let bestTime = 1;\n\n    for (let y = minTileY; y <= maxTileY && y < this.height; y++) {\n      for (let x = minTileX; x <= maxTileX && x < this.width; x++) {\n        if (this.tileLayers[0].data[this.getTileIndex(x, y)] !== 0) {\n          if (this.willCollide(entity, x, y)) {\n            const tileNormal = [0, 0];\n            let tileTime = 1;\n            const tileLeft = x * TILE_SIZE;\n            const tileRight = tileLeft + TILE_SIZE;\n            const tileBottom = y * TILE_SIZE;\n            const tileTop = tileBottom + TILE_SIZE;\n\n            if (tileTop < entity.pos[1]) {\n              tileNormal[1] = 1;\n              if (entity.dP[1] < 0) {\n                const distance = ((y + 1) * TILE_SIZE) - (entity.pos[1] - entity.radius);\n                tileTime = Math.min(distance / entity.dP[1], tileTime);\n              }\n            } else if (tileBottom > entity.pos[1]) {\n              tileNormal[1] = -1;\n              if (entity.dP[1] > 0) {\n                const distance = (y * TILE_SIZE) - (entity.pos[1] + entity.radius);\n                tileTime = Math.min(distance / entity.dP[1], tileTime);\n              }\n            } else if (tileRight < entity.pos[0]) {\n              tileNormal[0] = 1;\n              if (entity.dP[0] < 0) {\n                const distance = ((x + 1) * TILE_SIZE) - (entity.pos[0] - entity.radius);\n                tileTime = Math.min(distance / entity.dP[0], tileTime);\n              }\n            } else if (tileLeft > entity.pos[0]) {\n              tileNormal[0] = -1;\n              if (entity.dP[0] > 0) {\n                const distance = (x * TILE_SIZE) - (entity.pos[0] + entity.radius);\n                tileTime = Math.min(distance / entity.dP[0], tileTime);\n              }\n            }\n\n            // TODO: Collision system crappiness! Can bump off the top corner of\n            // a tile even though you can only access the top.\n\n            if (tileTime <= bestTime) {\n              bestTime = Math.max(tileTime, 0);\n              v2.clone(normal, tileNormal);\n            }\n          }\n        }\n      }\n    }\n    v2.normalise(normal, normal);\n    return { time: bestTime, normal };\n  }\n\n  /**\n   * The context should be pre-transformed to the correct viewport and orientation\n   */\n  draw(context: CanvasRenderingContext2D) {\n    for (let y = 0; y < this.height; y++) {\n      for (let x = 0; x < this.width; x++) {\n        const tile = this.tileLayers[0].data[this.getTileIndex(x, y)];\n        if (tile !== 0) {\n          context.fillStyle = tileColors[tile].light;\n          context.fillRect((x * TILE_SIZE), (y * TILE_SIZE), TILE_SIZE, TILE_SIZE);\n          context.fillStyle = tileColors[tile].dark;\n          context.beginPath();\n          context.moveTo((x * TILE_SIZE), (y * TILE_SIZE));\n          context.lineTo(((1 + x) * TILE_SIZE), (y * TILE_SIZE));\n          context.lineTo(((1 + x) * TILE_SIZE), ((1 + y) * TILE_SIZE));\n          context.closePath();\n          context.fill();\n          // context.strokeStyle = 'white';\n          // context.strokeRect(x * TILE_SIZE, y * TILE_SIZE, TILE_SIZE, TILE_SIZE);\n        }\n      }\n    }\n  }\n}\n","import Entity from './entity';\nimport { EntityType } from './entityType';\nimport { V2, v2 } from './maths';\nimport WorldMap from './worldMap';\n\nconst levelFiles = ['level1.json', 'level2.json', 'level3.json', 'level4.json'];\nconst levels: Level[] = [];\n\nexport const levelsLoaded = Promise.all(levelFiles.map(loadLevel));\n\nexport function getLevel(id: number) {\n  return levels[id % levels.length];\n}\n\nasync function loadLevel(name: string, index: number) {\n  const response = await fetch(`levels/${name}`);\n  const data = await response.json();\n  const map = new WorldMap(data);\n  const level = new Level(map);\n  levels[index] = level;\n}\n\n// Stupidness. Tiled shows the ids as one less than actually found in the file\nenum MapObjectType {\n  Spawn = 65,\n  Exit = 66,\n  Creature1 = 97,\n  Creature2 = 98,\n  Creature3 = 99,\n  GrenadePickup = 100,\n  Mcguffin = 129,\n  Heart = 130,\n  Spikes = 131,\n}\n\nconst ObjectToEntityMap: {[key: number]: EntityType} = {\n  [MapObjectType.Exit]: EntityType.Exit,\n  [MapObjectType.Creature1]: EntityType.Goblin,\n  [MapObjectType.Creature2]: EntityType.GoblinArcher,\n  [MapObjectType.Creature3]: EntityType.Floater,\n  [MapObjectType.Heart]: EntityType.Heart,\n  [MapObjectType.Mcguffin]: EntityType.Mcguffin,\n  [MapObjectType.Spikes]: EntityType.Spikes,\n  [MapObjectType.GrenadePickup]: EntityType.GrenadePickup,\n};\n\nexport class Level {\n  spawn: V2 = v2.create();\n  mcguffinCount = 0;\n\n  constructor(public map: WorldMap) {\n    // TODO: Set spawn from map here\n    for (const layer of map.objectLayers) {\n      for (const obj of layer.objects) {\n        const type = obj.gid as MapObjectType;\n        if (type === MapObjectType.Spawn) {\n          v2.clone(this.spawn, map.translateObjectPosition(obj.x, obj.y));\n        }\n        if (type === MapObjectType.Mcguffin) {\n          this.mcguffinCount++;\n        }\n      }\n    }\n  }\n\n  getEntities(): Entity[] {\n    const result: Entity[] = [];\n\n    for (const layer of this.map.objectLayers) {\n      for (const obj of layer.objects) {\n        const type = obj.gid as MapObjectType;\n        if (ObjectToEntityMap[type]) {\n          result.push(new Entity(ObjectToEntityMap[type], this.map.translateObjectPosition(obj.x, obj.y)));\n        }\n      }\n    }\n    return result;\n  }\n}\n","import { addBanner, addTopBanner } from './banner';\nimport Entity from './entity';\nimport { EntityType } from './entityType';\nimport { getLevel, Level } from './levels';\nimport { v2 } from './maths';\n\nexport enum WeaponType {\n  Gun,\n  Grenade,\n}\n\nexport const entities: Set<Entity> = new Set();\nexport let player: Entity;\nexport let level: Level;\nexport let paused = false;\nexport const weaponsAvailable: WeaponType[] = [WeaponType.Gun];\nexport const debuffs = {\n  doubleDamage: false,\n  fastMonsters: false,\n  noHeal: false,\n  slowRegen: false,\n  undead: false,\n};\n\nlet currentLevelId = 0;\n\nexport function reset() {\n  player = new Entity(EntityType.Player, [20, 20]);\n  changeLevel(currentLevelId);\n}\n\nexport function togglePause() {\n  paused = !paused;\n}\n\nexport function nextLevel() {\n  changeLevel(currentLevelId + 1);\n}\n\nexport function addDebuff() {\n  const available: string[] = [];\n\n  if (!debuffs.doubleDamage) {\n    available.push('doubleDamage');\n  }\n  if (!debuffs.noHeal) {\n    available.push('noHeal');\n  }\n  if (!debuffs.fastMonsters) {\n    available.push('fastMonsters');\n  }\n  if (!debuffs.slowRegen) {\n    available.push('slowRegen');\n  }\n  if (!debuffs.undead) {\n    available.push('undead');\n  }\n\n  const choice = Math.floor(Math.random() * available.length);\n\n  switch (available[choice]) {\n    case 'doubleDamage': {\n      debuffs.doubleDamage = true;\n      addBanner('Curse: Enemy Damage X2', 50);\n      break;\n    }\n    case 'fastMonsters': {\n      debuffs.fastMonsters = true;\n      addBanner('Curse: Fast enemies', 50);\n      break;\n    }\n    case 'noHeal': {\n      debuffs.noHeal = true;\n      addBanner('Curse: No healing', 50);\n      break;\n    }\n    case 'slowRegen': {\n      debuffs.slowRegen = true;\n      addBanner('Curse: Ammo regen 50%', 50);\n      break;\n    }\n    case 'undead': {\n      debuffs.undead = true;\n      addBanner(`Curse: Enemies don't stay dead`, 45);\n      break;\n    }\n  }\n}\n\nexport function changeLevel(id: number) {\n  addTopBanner(`Level ${id + 1}`, 80);\n  if (id === 0) {\n    addBanner('A,  D to move', 30);\n    addBanner('Space to jump', 30);\n    addBanner('Arrow keys shoot', 30);\n    addBanner('Collect cursed lava lamps to open the door', 30);\n    addBanner('Lava lamp curses last the rest of the level', 30);\n    addBanner('(or until you die!)', 30);\n  }\n\n  debuffs.doubleDamage = false;\n  debuffs.fastMonsters = false;\n  debuffs.noHeal = false;\n  debuffs.slowRegen = false;\n  debuffs.undead = false;\n\n  currentLevelId = id;\n  level = getLevel(id);\n  entities.clear();\n  v2.clone(player.pos, level.spawn);\n  player.mcguffins = [];\n  const levelEntities = level.getEntities();\n  entities.add(player);\n  for (const entity of levelEntities) {\n    entities.add(entity);\n  }\n}\n","import { Facing } from './entity';\nimport { V2 } from './maths';\nimport { err } from './utils';\n\nconst spritesheet: HTMLImageElement = new Image();\n\nexport const spritesLoaded = new Promise((resolve, reject) => {\n  spritesheet.onload = resolve;\n  spritesheet.onerror = reject;\n});\n\nspritesheet.src = 'assets/sprites.png';\n\nfunction getCanvas(width: number, height: number): [HTMLCanvasElement, CanvasRenderingContext2D] {\n  const canvas = document.createElement('canvas');\n\n  canvas.width = width;\n  canvas.height = height;\n\n  const context = canvas.getContext('2d') || err();\n\n  return [canvas, context];\n}\n\nfunction makeGoblinGraphic(color: string): HTMLCanvasElement {\n  const [canvas, context] = getCanvas(20, 20);\n\n  context.translate(10, 10);\n  context.fillStyle = color;\n  context.strokeStyle = 'white';\n  context.beginPath();\n  context.arc(0, 0, 8, 0, Math.PI * 2, false);\n  context.fill();\n  context.stroke();\n  context.fillRect(8, -4, 2, 8);\n\n  return canvas;\n}\n\nfunction makePlayerGraphic(): HTMLCanvasElement {\n  const [canvas, context] = getCanvas(16, 16);\n\n  context.fillStyle = 'purple';\n  context.strokeStyle = 'white';\n  context.fillRect(0, 0, 16, 16);\n  context.strokeRect(0, 0, 16, 16);\n\n  return canvas;\n}\n\nfunction makeFallbackGraphic() {\n  const [canvas, context] = getCanvas(32, 32);\n\n  context.fillStyle = 'blue';\n  context.fillRect(0, 0, 32, 32);\n\n  context.strokeStyle = 'white';\n  context.beginPath();\n  context.moveTo(0, 0);\n  context.lineTo(31, 31);\n  context.moveTo(0, 31);\n  context.lineTo(31, 0);\n  context.stroke();\n\n  return canvas;\n}\n\nfunction makeProjectileGraphic() {\n  const [canvas, context] = getCanvas(10, 10);\n\n  context.fillStyle = 'yellow';\n  context.strokeStyle = 'black';\n\n  context.beginPath();\n  context.arc(4, 4, 4, 0, Math.PI * 2, false);\n  context.fill();\n  context.stroke();\n\n  return canvas;\n}\n\nfunction makeGrenadeGraphic() {\n  const [canvas, context] = getCanvas(16, 16);\n\n  context.fillStyle = 'black';\n  context.strokeStyle = 'black';\n\n  context.beginPath();\n  context.arc(8, 8, 8, 0, Math.PI * 2, false);\n  context.fill();\n  context.beginPath();\n  context.moveTo(8, 8);\n  context.lineTo(16, 16);\n  context.stroke();\n  context.strokeStyle = 'yellow';\n\n  context.beginPath();\n  context.moveTo(15, 15);\n  context.lineTo(16, 16);\n  context.stroke();\n\n  return canvas;\n}\n\nfunction makeHeartGraphic() {\n  const [canvas, context] = getCanvas(32, 32);\n\n  const tileX = 1;\n  const tileY = 4;\n\n  spritesLoaded.then(() => {\n    context.translate(0, 32);\n    context.scale(1, -1);\n    context.drawImage(spritesheet, tileX * 32, tileY * 32, 32, 32, 0, 0, 32, 32);\n  });\n\n  return canvas;\n}\n\nfunction makeMcguffinGraphic() {\n  const [canvas, context] = getCanvas(32, 32);\n\n  const tileX = 0;\n  const tileY = 4;\n\n  spritesLoaded.then(() => {\n    context.translate(0, 32);\n    context.scale(1, -1);\n    context.drawImage(spritesheet, tileX * 32, tileY * 32, 32, 32, 0, 0, 32, 32);\n  });\n\n  return canvas;\n}\n\nfunction makeExitGraphic() {\n  const [canvas, context] = getCanvas(32, 32);\n\n  const tileX = 1;\n  const tileY = 2;\n\n  spritesLoaded.then(() => {\n    context.translate(0, 32);\n    context.scale(1, -1);\n    context.drawImage(spritesheet, tileX * 32, tileY * 32, 32, 32, 0, 0, 32, 32);\n  });\n\n  return canvas;\n}\n\nfunction makeSpikesGraphic() {\n  const [canvas, context] = getCanvas(32, 32);\n\n  const tileX = 2;\n  const tileY = 4;\n\n  spritesLoaded.then(() => {\n    context.translate(0, 32);\n    context.scale(1, -1);\n    context.drawImage(spritesheet, tileX * 32, tileY * 32, 32, 32, 0, 0, 32, 32);\n  });\n\n  return canvas;\n}\n\nfunction makeFloaterGraphic() {\n  const [canvas, context] = getCanvas(32, 32);\n\n  const tileX = 0;\n  const tileY = 3;\n\n  spritesLoaded.then(() => {\n    context.translate(0, 32);\n    context.scale(1, -1);\n    context.drawImage(spritesheet, tileX * 32, tileY * 32, 32, 32, 0, 0, 32, 32);\n  });\n\n  return canvas;\n}\n\nfunction makeGunIconGraphic() {\n  const [canvas, context] = getCanvas(32, 32);\n\n  const tileX = 3;\n  const tileY = 4;\n\n  spritesLoaded.then(() => {\n    // context.translate(0, 32);\n    // context.scale(1, -1);\n    context.drawImage(spritesheet, tileX * 32, tileY * 32, 32, 32, 0, 0, 32, 32);\n  });\n\n  return canvas;\n}\n\nfunction makeBombIconGraphic() {\n  const [canvas, context] = getCanvas(32, 32);\n\n  const tileX = 3;\n  const tileY = 3;\n\n  spritesLoaded.then(() => {\n    // context.translate(0, 32);\n    // context.scale(1, -1);\n    context.drawImage(spritesheet, tileX * 32, tileY * 32, 32, 32, 0, 0, 32, 32);\n  });\n\n  return canvas;\n}\n\nexport const playerGraphic = makePlayerGraphic();\nexport const fallbackGraphic = makeFallbackGraphic();\nexport const goblinGraphic = makeGoblinGraphic('orange');\nexport const goblinArcherGraphic = makeGoblinGraphic('red');\nexport const heartGraphic = makeHeartGraphic();\nexport const mcguffinGraphic = makeMcguffinGraphic();\nexport const projectileGraphic = makeProjectileGraphic();\nexport const exitGraphic = makeExitGraphic();\nexport const spikesGraphic = makeSpikesGraphic();\nexport const grenadeGraphic = makeGrenadeGraphic();\nexport const gunIconGraphic = makeGunIconGraphic();\nexport const bombIconGraphic = makeBombIconGraphic();\nexport const floaterGraphic = makeFloaterGraphic();\n","const images = [\n  'sprites.png',\n];\n\nconst music: string[] = [];\n\nconst other = [\n  'click.wav',\n  'click2.wav',\n  'explosion1.wav',\n  'pop.wav',\n  'squelch1.wav',\n  'urgh.wav',\n  'whoop.wav',\n];\n\ntype Asset = HTMLImageElement | HTMLAudioElement | ArrayBuffer;\n\nconst loaded: Map<string, Asset> = new Map();\n\nfunction makeURL(filename: string): string {\n  return `assets/${filename}`;\n}\n\nlet pending = 0;\n\nexport const assetsLoaded = new Promise((resolve, reject) => {\n  const success = (url: string, object: Asset) => {\n    pending--;\n    loaded.set(url, object);\n    if (pending === 0) {\n      resolve();\n    }\n  };\n\n  const fail = (url: string, err: Error | string) => {\n    pending--;\n    console.log(`Couldn't load ${url}: ${err}`);\n    if (pending === 0) {\n      resolve();\n    }\n  };\n\n  for (const imageURL of images) {\n    pending++;\n    const image = new Image();\n    image.src = makeURL(imageURL);\n    image.onload = () => success(imageURL, image);\n    image.onerror = (e) => fail(imageURL, e.error);\n  }\n\n  for (const musicURL of music) {\n    pending++;\n    const audio = document.createElement('audio');\n    audio.src = makeURL(musicURL);\n    audio.oncanplay = () => success(musicURL, audio);\n    audio.onerror = (e) => fail(musicURL, e.error);\n  }\n\n  for (const url of other) {\n    pending++;\n    fetch(makeURL(url)).then((response) => response.arrayBuffer())\n      .then((buffer) => success(url, buffer))\n      .catch((reason) => fail(url, reason));\n  }\n});\n\n// TODO: Progress meter\n\nexport function getAsset(name: string): Asset | undefined {\n  return loaded.get(name);\n}\n","import {assetsLoaded, getAsset} from './assets';\nimport { clamp } from './utils';\n\nconst soundAssets: string[] = [\n  'click',\n  'click2',\n  'explosion1',\n  'pop',\n  'squelch1',\n  'urgh',\n  'whoop',\n];\n\nconst sounds: Map<string, AudioBuffer> = new Map();\nconst context = new AudioContext();\n\nconst soundGainNode = context.createGain();\nconst musicGainNode = context.createGain();\n\nsoundGainNode.connect(context.destination);\nmusicGainNode.connect(context.destination);\n\nassetsLoaded.then(() => {\n  for (const name of soundAssets) {\n    const data = getAsset(`${name}.wav`) as ArrayBuffer;\n    context.decodeAudioData(data, (buffer) => {\n      sounds.set(name, buffer);\n    });\n  }\n});\n\nclass SoundManager {\n  get musicVolume() {\n    return musicGainNode.gain.value;\n  }\n\n  set musicVolume(value: number) {\n    value = clamp(value, 0, 1);\n    musicGainNode.gain.value = value;\n  }\n\n  get soundVolume() {\n    return soundGainNode.gain.value;\n  }\n\n  set soundVolume(value: number) {\n    value = clamp(value, 0, 1);\n    soundGainNode.gain.value = value;\n  }\n\n  play(name: string) {\n    if (sounds.has(name)) {\n      const source = context.createBufferSource();\n      source.buffer = sounds.get(name)!;\n      source.connect(soundGainNode);\n      source.start();\n    }\n  }\n\n  connectMusic(audio: HTMLAudioElement) {\n    const source = context.createMediaElementSource(audio);\n    source.connect(musicGainNode);\n  }\n}\nexport default new SoundManager();\n","import { addBanner } from './banner';\nimport { intersect } from './collision';\nimport controls, { Key } from './controls';\nimport { EntityType } from './entityType';\nimport {\n  addDebuff, debuffs, entities, level, nextLevel, player, reset, togglePause, weaponsAvailable, WeaponType,\n} from './gameState';\nimport {\n  bombIconGraphic, exitGraphic, fallbackGraphic, floaterGraphic, goblinArcherGraphic, goblinGraphic, grenadeGraphic,\n  heartGraphic, mcguffinGraphic, playerGraphic, projectileGraphic, spikesGraphic,\n} from './graphic';\nimport { V2, v2 } from './maths';\nimport sound from './sound';\n\nconst g = [0, -980];\nconst EPSILON = 0.00000001;\n\nenum Faction {\n  Foe,\n  Friend,\n  Neither,\n}\n\nexport enum Facing {\n  Left,\n  Right,\n  Up,\n  Down,\n}\n\nenum CollisionResponse {\n  Bounce,\n  Stop,\n  Deflect,\n  TurnAround,\n}\n\nexport default class Entity {\n  pos: V2 = v2.create();\n  dP: V2 = v2.create();\n  v: V2 = v2.create();\n  dV: V2 = v2.create();\n  facing = Facing.Right;\n\n  // flags\n  collidable = true; // Does this entity interact with things in the same space?\n  killable = false;\n  controlled = false;\n  // solid = false; // Solid entities cannot be in the same space as each other\n  limitedLife = false;\n  harmful = false;\n  flying = false;\n  onGround = false;\n  pacer = false;\n  destroyOnUse = false;\n  collectable = false;\n  undead = false;\n  explodes = false;\n  isExplosion = false; // Fairly desperate stuff at this hour\n  floater = false;\n\n  collisionResponse = CollisionResponse.Deflect;\n  health = 0;\n  maxHealth = 100;\n  speed = 1000;\n  lifespan = 0;\n  damage = 0;\n  faction = Faction.Foe;\n  // TODO: Weapons should be their own thing, not part of entity\n  weaponTimer = 0;\n  weaponRange = 200;\n  radius = 8;\n  target: Entity | null = null;\n  onhit: ((e: Entity) => void) | null;\n  mcguffins: any[] = []; // TODO: Make these better typed\n  cooldown: number = 0; // Generic, used for lots of things\n  ammo = 0;\n  ammoMax = 0;\n  ammoRegen = 1;\n  ammoTimer = 0;\n  weaponType: WeaponType = WeaponType.Gun;\n  explosionTimer = 0;\n\n  graphic = fallbackGraphic;\n\n  constructor(type: EntityType, pos: V2, options: { [key: string]: any } = {}) {\n    v2.clone(this.pos, pos);\n\n    switch (type) {\n      case EntityType.Player: {\n        this.controlled = true;\n        this.killable = true;\n        this.maxHealth = 100;\n        this.graphic = playerGraphic;\n        this.speed = 2000;\n        // this.solid = true;\n        this.faction = Faction.Friend;\n        this.ammoMax = 50;\n        this.ammo = 50;\n        break;\n      }\n\n      case EntityType.Floater: {\n        this.killable = true;\n        this.maxHealth = 10;\n        this.health = 10;\n        this.graphic = floaterGraphic;\n        this.speed = 500;\n        this.radius = 8;\n        this.harmful = true;\n        this.damage = 100;\n        this.flying = true;\n        this.floater = true;\n        this.collisionResponse = CollisionResponse.Bounce;\n        this.target = player;\n        break;\n      }\n\n      case EntityType.GrenadePickup: {\n        this.graphic = bombIconGraphic;\n        this.faction = Faction.Friend;\n        this.radius = 16;\n        this.onhit = (other: Entity) => {\n          weaponsAvailable.push(WeaponType.Grenade);\n          addBanner('New Weapon: Grenades', 40);\n          this.die();\n        };\n        break;\n      }\n\n      case EntityType.Goblin: {\n        this.killable = true;\n        this.maxHealth = 20;\n        this.graphic = goblinGraphic;\n        this.speed = 1000;\n        // this.solid = true;\n        this.pacer = true;\n        this.harmful = true;\n        this.damage = 100;\n        this.collisionResponse = CollisionResponse.TurnAround;\n        break;\n      }\n\n      case EntityType.GoblinArcher: {\n        this.killable = true;\n        this.maxHealth = 40;\n        this.graphic = goblinArcherGraphic;\n        this.speed = 1000;\n        // this.solid = true;\n        this.pacer = true;\n        this.harmful = true;\n        this.damage = 100;\n        this.collisionResponse = CollisionResponse.TurnAround;\n        this.target = player;\n        this.ammo = 100;\n        this.ammoMax = 100;\n        this.ammoRegen = 0.1;\n        break;\n      }\n\n      case EntityType.Spikes: {\n        this.graphic = spikesGraphic;\n        this.harmful = true;\n        this.damage = 100;\n        this.flying = true;\n        break;\n      }\n\n      case EntityType.Projectile: {\n        this.graphic = projectileGraphic;\n        this.faction = options.faction || Faction.Foe;\n        this.facing = options.facing || Facing.Left;\n        switch (this.facing) {\n          case Facing.Left: {\n            v2.set(this.v, -1000, 0);\n            break;\n          }\n          case Facing.Right: {\n            v2.set(this.v, 1000, 0);\n            break;\n          }\n          case Facing.Up: {\n            v2.set(this.v, 0, 1000);\n            break;\n          }\n          case Facing.Down: {\n            v2.set(this.v, 0, -1000);\n            break;\n          }\n        }\n        this.radius = 4;\n        this.limitedLife = true;\n        this.lifespan = 2;\n        this.harmful = true;\n        this.damage = 10;\n        this.flying = true;\n        this.destroyOnUse = true;\n        break;\n      }\n\n      case EntityType.Heart: {\n        this.graphic = heartGraphic;\n        this.faction = Faction.Friend;\n        this.radius = 16;\n        this.collectable = true;\n        this.health = 30;\n        break;\n      }\n\n      case EntityType.Grenade: {\n        this.graphic = grenadeGraphic;\n        this.radius = 8;\n        this.faction = options.faction || Faction.Foe;\n        this.explosionTimer = 2;\n        this.explodes = true;\n        this.facing = options.facing || Facing.Left;\n        switch (this.facing) {\n          case Facing.Left: {\n            v2.set(this.v, -400, 300);\n            break;\n          }\n          case Facing.Right: {\n            v2.set(this.v, 400, 300);\n            break;\n          }\n          case Facing.Up: {\n            v2.set(this.v, 0, 500);\n            break;\n          }\n          case Facing.Down: {\n            v2.set(this.v, 0, -500);\n            break;\n          }\n        }\n        break;\n      }\n\n      case EntityType.Explosion: {\n        this.radius = 0;\n        this.damage = 100;\n        this.faction = Faction.Neither;\n        this.harmful = true;\n        this.isExplosion = true;\n        this.flying = true;\n        this.limitedLife = true;\n        this.lifespan = 1;\n        break;\n      }\n\n      case EntityType.Exit: {\n        this.graphic = exitGraphic;\n        this.faction = Faction.Friend;\n        this.radius = 16;\n        this.flying = true;\n        this.onhit = () => {\n          if (level.mcguffinCount === player.mcguffins.length) {\n            nextLevel();\n          } else {\n            if (this.cooldown === 0) {\n              addBanner('Collect more Lava Lamps', 20);\n              sound.play('click2');\n              this.cooldown += 0.5;\n            }\n          }\n        };\n        break;\n      }\n\n      case EntityType.Mcguffin: {\n        this.graphic = mcguffinGraphic;\n        this.faction = Faction.Friend;\n        this.radius = 16;\n        this.onhit = (entity: Entity) => {\n          // TODO: show something to the player about the new effect\n          // TODO: Create some effects\n          entity.mcguffins.push({});\n          addDebuff();\n          sound.play('click');\n          this.die();\n        };\n        break;\n      }\n    }\n\n    if (this.killable) {\n      this.health = this.maxHealth;\n    }\n  }\n\n  update(dT: number) {\n    v2.set(this.dV, 0, 0);\n\n    if (this.weaponTimer > 0) {\n      this.weaponTimer = Math.max(0, this.weaponTimer - dT);\n    }\n\n    if (this.cooldown > 0) {\n      this.cooldown = Math.max(0, this.cooldown - dT);\n    }\n\n    if (this.limitedLife) {\n      this.lifespan -= dT;\n    }\n\n    if (this.lifespan < 0) {\n      return this.die();\n    }\n\n    if (this.health <= 0 && this.killable) {\n      if (debuffs.undead && this !== player) {\n        this.undead = true;\n        this.speed = 0;\n        this.health = 10;\n      } else {\n        return this.die();\n      }\n    }\n\n    if (this.explodes) {\n      this.explosionTimer -= dT;\n      if (this.explosionTimer < 0) {\n        entities.add(new Entity(EntityType.Explosion, this.pos));\n        this.die();\n      }\n    }\n\n    if (this.isExplosion) {\n      this.radius = Math.pow(1 - this.lifespan, 0.5) * 50;\n    }\n\n    if (this.undead && this.speed < 1000) {\n      this.speed += 100 * dT;\n    }\n\n    if (this.ammo === this.ammoMax) {\n      this.ammoTimer = Math.max(0, this.ammoTimer);\n    } else if (this.ammoTimer > 0) {\n      this.ammoTimer -= dT;\n    }\n\n    if (this.ammo < this.ammoMax && this.ammoTimer <= 0) {\n      this.ammo++;\n      this.ammoTimer += this.ammoRegen;\n      if (debuffs.slowRegen) {\n        this.ammoTimer += this.ammoRegen;\n      }\n    }\n\n    if (this.controlled) {\n      this.playerControl(dT);\n    } else {\n      if (this.pacer) {\n        this.dV[0] = this.facing === Facing.Left ? -1 : 1;\n      }\n      if (this.target) {\n        const tVec = v2.create();\n        v2.sub(tVec, this.target.pos, this.pos);\n        const direction = v2.angle(tVec);\n\n        this.facing = this.target.pos[0] < this.pos[0] ? Facing.Left : Facing.Right;\n\n        if (!this.floater) {\n          if (this.weaponRange >= v2.length(tVec)) {\n            this.shoot(this.facing);\n          }\n        }\n\n        v2.normalise(tVec, tVec);\n\n        if (this.floater) {\n          v2.add(tVec, tVec, [Math.random() * 0.1, Math.random() * 0.1]);\n          v2.normalise(tVec, tVec);\n          if (v2.distance(this.pos, player.pos) > 300) {\n            v2.mul(tVec, tVec, 0.05);\n          }\n        }\n\n        v2.clone(this.dV, tVec);\n      }\n    }\n\n    v2.mul(this.dV, this.dV, this.speed);\n\n    if (debuffs.fastMonsters && this.faction === Faction.Foe) {\n      v2.mul(this.dV, this.dV, 2);\n    }\n    if (this.undead) {\n      v2.mul(this.dV, this.dV, 0.5);\n    }\n\n    if (!this.onGround && !this.flying) {\n      v2.mul(this.dV, this.dV, 0.2);\n    }\n\n    // Friction\n    const fricAcc = v2.create();\n    v2.mul(fricAcc, this.v, this.onGround ? -12 : -1);\n    v2.add(this.dV, this.dV, fricAcc);\n\n    if (!this.flying) {\n      v2.add(this.dV, this.dV, g);\n    }\n\n    v2.mul(this.dV, this.dV, dT); // a => at\n    // equations of motion\n    // v = at + u\n    v2.add(this.v, this.dV, this.v);\n    // dP = ut + (1/2)at^2\n    const ut = v2.create();\n    v2.mul(ut, this.v, dT);\n    v2.mul(this.dP, this.dV, 0.5 * dT); // dP = (1/2)at^2\n    v2.add(this.dP, ut, this.dP);\n\n    this.onGround = false;\n    if (this.collidable) {\n      let attempts = 4;\n      while (attempts--) {\n        const collision = level.map.findCollision(this);\n        if (collision.time < 1 && !v2.isZero(collision.normal)) {\n          if (collision.normal[1] > 0.5) {\n            this.onGround = true;\n          }\n\n          if (attempts === 0) {\n            v2.set(this.dP, 0, 0);\n            console.log('Too many collisions, giving up');\n          } else {\n            this.updateMove(collision.normal, collision.time);\n          }\n          this.hit(null, dT);\n        }\n      }\n    }\n\n    for (const other of entities) {\n      if (other !== this && other.collidable && this.willCollide(other)) {\n        this.hit(other, dT);\n        other.hit(this, dT);\n        // if (this.solid && other.solid) {\n        //   // TODO: bouncing/deflection here\n        //   v2.set(this.dP, 0, 0);\n        // }\n      }\n    }\n\n    if (this.v[0] !== 0) {\n      this.facing = this.v[0] < 0 ? Facing.Left : Facing.Right;\n    }\n\n    v2.add(this.pos, this.pos, this.dP);\n  }\n\n  shoot(facing: Facing) {\n    if (this.weaponTimer === 0 && this.ammo > 0) {\n      if (this.weaponType === WeaponType.Gun) {\n        entities.add(new Entity(EntityType.Projectile, this.pos, { facing, faction: this.faction }));\n        this.ammo--;\n      } else if (this.weaponType === WeaponType.Grenade) {\n        entities.add(new Entity(EntityType.Grenade, this.pos, { facing, faction: this.faction }));\n        this.ammo -= 10;\n      }\n      sound.play('pop');\n      this.weaponTimer += 0.1;\n    }\n  }\n\n  playerControl(dT: number) {\n    v2.set(this.dV, 0, 0);\n    if (controls.isPressed(Key.Space) && this.onGround) {\n      this.v[1] += 600;\n      sound.play('whoop');\n    }\n    // if (controls.isPressed(Key.S)) {\n    //   this.dV[1] = -1;\n    // }\n    if (controls.isPressed(Key.A)) {\n      this.dV[0] = -1;\n    }\n    if (controls.isPressed(Key.D)) {\n      this.dV[0] = 1;\n    }\n\n    if (controls.isPressed(Key.Up)) {\n      this.shoot(Facing.Up);\n    }\n    if (controls.isPressed(Key.Down)) {\n      this.shoot(Facing.Down);\n    }\n    if (controls.isPressed(Key.Left)) {\n      this.shoot(Facing.Left);\n    }\n    if (controls.isPressed(Key.Right)) {\n      this.shoot(Facing.Right);\n    }\n\n    if (weaponsAvailable.includes(WeaponType.Gun) && controls.isPressed(Key.One)) {\n      this.weaponType = WeaponType.Gun;\n    }\n    if (weaponsAvailable.includes(WeaponType.Grenade) && controls.isPressed(Key.Two)) {\n      this.weaponType = WeaponType.Grenade;\n    }\n\n    v2.normalise(this.dV, this.dV);\n  }\n\n  collisionSupport(direction: V2): V2 {\n    const result = v2.create();\n    v2.normalise(direction, direction);\n    v2.mul(result, direction, this.radius);\n    v2.add(result, this.pos, result);\n    if (!v2.isZero(this.dP)) {\n      const angle = v2.dot(this.dP, direction);\n      if (angle > 0) {\n        v2.add(result, result, this.dP);\n      }\n    }\n    return result;\n  }\n\n  willCollide(other: Entity) {\n    // Assume that all entities are circles for collision\n    const support = this.collisionSupport;\n    return intersect(support.bind(this), support.bind(other));\n  }\n\n  updateMove(normal: V2, proportion: number) {\n    let bounceAmount = 1 - proportion;\n    if (this.collisionResponse === CollisionResponse.Bounce) {\n      bounceAmount += 0.9;\n    }\n\n    switch (this.collisionResponse) {\n      case CollisionResponse.TurnAround: {\n        if (this.dP[0] !== 0) {\n          this.facing = this.facing === Facing.Left ? Facing.Right : Facing.Left;\n        }\n      }\n      case CollisionResponse.Bounce:\n      case CollisionResponse.Deflect: {\n        const vDiff = v2.create();\n        const dpDiff = v2.create();\n\n        v2.mul(dpDiff, normal, bounceAmount * v2.dot(this.dP, normal));\n        v2.sub(this.dP, this.dP, dpDiff);\n\n        v2.mul(vDiff, normal, bounceAmount * v2.dot(this.v, normal));\n        v2.sub(this.v, this.v, vDiff);\n        break;\n      }\n\n      case CollisionResponse.Stop: {\n        v2.set(this.dP, 0, 0);\n        v2.set(this.v, 0, 0);\n        break;\n      }\n    }\n  }\n\n  /**\n   * If other is null then we collided with a wall\n   */\n  hit(other: Entity | null, dT: number) {\n    if (!other) {\n      if (this.harmful && this.destroyOnUse) {\n        this.die();\n      }\n      return;\n    }\n\n    if (this.onhit && other === player) {\n      this.onhit(other);\n    }\n\n    if (this.killable && other.harmful && this.faction !== other.faction) {\n      let damage = other.damage;\n      if (this === player && debuffs.doubleDamage) {\n        damage *= 2;\n      }\n      if (other.destroyOnUse) {\n        this.health -= damage;\n        sound.play('urgh');\n        other.die();\n      } else {\n        if (other.cooldown === 0) {\n          this.health -= damage * 0.25;\n          other.cooldown += 0.25;\n          sound.play('urgh');\n        }\n      }\n    }\n\n    if (this.collectable && this.faction === other.faction) {\n      if (this.health > 0 && other.health < other.maxHealth) {\n        if (!debuffs.noHeal) {\n          other.health = Math.min(other.maxHealth, other.health + this.health);\n        }\n        return this.die();\n      }\n    }\n  }\n\n  die() {\n    entities.delete(this);\n\n    if (this.killable) {\n      sound.play('squelch1');\n    }\n\n    if (this === player) {\n      reset();\n    }\n  }\n}\n","import { drawBanner, drawTopBanner } from './banner';\nimport controls, { Key } from './controls';\nimport { canvas, context } from './display';\nimport Entity, { Facing } from './entity';\nimport { entities, level, paused, player, reset, togglePause, weaponsAvailable, WeaponType } from './gameState';\nimport { bombIconGraphic, gunIconGraphic, spritesLoaded } from './graphic';\nimport { levelsLoaded } from './levels';\nimport { V2, v2 } from './maths';\n\n// The more you have, the worse it gets\n// ====================================\n//\n// Platformer. You must collect, say, 5 mcguffins per level. Each mcguffin adds a\n// complication. Like, you take double damage, or more monsters spawn. Or\n// perhaps visibilty gets worse. Something like that!\n// - Tile based\n// - Totally 2D\n// - Probably not WebGL during the compo\n\n// Weapons:\n// - pistol\n// - sword\n// - machine gun\n// - grenades\n\n// Debuffs:\n// - monsters faster\n// - can't heal\n// - double damage\n// - ammo regen slower\n// Maybe:\n// - can't change weapon\n// - Something that makes spikes harder\n\n// import { buildTime } from 'build-info';\n\n// OKAY, let's code!\n\n// console.log(buildTime);\n\n// Just for the constructor\n\n// URGENT TODOS:\n// - more levels\n// - more creature types - flying? jumping?\n// - make creatures not walk off edges\n// - Better death effect (deadtimer for fade)\n\nlet lastFrameStart: number = 0;\nlet pauseHeld = false;\n\nfunction loop() {\n  if (lastFrameStart === 0) {\n    lastFrameStart = performance.now();\n  }\n\n  const frameStart = performance.now();\n  const dT = Math.min((frameStart - lastFrameStart) / 1000, 0.2);\n  lastFrameStart = frameStart;\n\n  if (controls.isPressed(Key.P)) {\n    if (!pauseHeld) {\n      togglePause();\n    }\n    pauseHeld = true;\n  } else {\n    pauseHeld = false;\n  }\n\n  if (!paused) {\n    for (const entity of entities) {\n      entity.update(dT);\n    }\n\n    if (player.pos[1] < 0) {\n      player.die();\n    }\n  }\n\n  context.save();\n\n  context.fillStyle = 'rgb(48, 48, 128)';\n  context.fillRect(0, 0, canvas.width, canvas.height);\n\n  context.translate((canvas.width / 4), (canvas.height / 4));\n  context.scale(1, -1);\n  context.translate(-player.pos[0], -player.pos[1]);\n\n  level.map.draw(context);\n\n  for (const entity of entities) {\n    context.save();\n    context.translate(entity.pos[0], entity.pos[1]);\n    if (entity.killable && entity.health < entity.maxHealth && entity !== player) {\n      context.fillStyle = 'red';\n      context.fillRect(-12, entity.radius + 4, 24 * (entity.health / entity.maxHealth), 5);\n    }\n    if (entity.facing === Facing.Left) {\n      context.scale(-1, 1);\n    }\n    if (entity.isExplosion) {\n      context.fillStyle = 'yellow';\n      context.beginPath();\n      context.arc(0, 0, entity.radius, 0, Math.PI * 2);\n      context.fill();\n    } else {\n      context.drawImage(entity.graphic, -entity.graphic.width / 2, -entity.graphic.height / 2);\n    }\n    context.restore();\n  }\n\n  context.restore();\n\n  drawTopBanner(context, dT);\n  drawBanner(context, dT);\n\n  drawGUI();\n\n  requestAnimationFrame(loop);\n}\n\nconst healthGradient = context.createLinearGradient(0, 0, 100, 20);\nhealthGradient.addColorStop(0, 'rgb(128, 0, 0)');\nhealthGradient.addColorStop(1, 'rgb(255, 55, 55)');\n\nfunction drawGUI() {\n  context.strokeStyle = 'white';\n  context.fillStyle = healthGradient;\n  context.fillRect(15, 15, 100 * player.health / player.maxHealth, 20);\n  context.strokeRect(15, 15, 100, 20);\n\n  context.font = '20px \"Fredoka One\", Arial, sans-serif';\n  context.fillStyle = 'white';\n  context.strokeStyle = 'black';\n  context.textBaseline = 'top';\n  context.fillText(String(player.ammo), 130, 15);\n  context.strokeText(String(player.ammo), 130, 15);\n\n  let weaponCounter = 0;\n\n  if (weaponsAvailable.includes(WeaponType.Gun)) {\n    context.fillText('1', 20, 56 + (50 * weaponCounter));\n    context.drawImage(gunIconGraphic, 45, 50 + (50 * weaponCounter));\n    if (player.weaponType === WeaponType.Gun) {\n      context.strokeStyle = 'white';\n      context.strokeRect(15, 45 + (50 * weaponCounter), 67, 42);\n    }\n    weaponCounter++;\n  }\n\n  if (weaponsAvailable.includes(WeaponType.Grenade)) {\n    context.fillText('2', 20, 56 + (50 * weaponCounter));\n    context.drawImage(bombIconGraphic, 45, 50 + (50 * weaponCounter));\n    if (player.weaponType === WeaponType.Grenade) {\n      context.strokeStyle = 'white';\n      context.strokeRect(15, 45 + (50 * weaponCounter), 67, 42);\n    }\n    weaponCounter++;\n  }\n}\n\nfunction init() {\n  reset();\n  requestAnimationFrame(loop);\n}\n\nconst loadingImage = new Image();\nloadingImage.src = 'assets/loading.png';\nloadingImage.onload = () => {\n  context.drawImage(loadingImage, 0, 0, canvas.width / 2, canvas.height / 2);\n  setTimeout(() => {\n    Promise.all([levelsLoaded, spritesLoaded]).then(init);\n  }, 3000);\n};\n"],"names":["bannerQueue","topBannerQueue","currentBanner","text","push","size","currentTopBanner","currentTimer","currentSize","MAX_TIME","currentTopTimer","currentTopSize","MAX_TOP_TIME","Math","max","length","shift","save","globalAlpha","font","textBaseline","fillStyle","strokeStyle","lineWidth","shadowOffsetX","shadowOffsetY","measureText","width","fillText","canvas","height","strokeText","restore","Error","floor","min","document","getElementById","context","getContext","err","targetAspect","scale","window","innerWidth","innerHeight","style","resize","addEventListener","webkitRequestFullscreen","body","appendChild","Key","keystate","controls","isPressed","keyCode","webkitFullscreenElement","keydown","keyup","v2","create","set","clone","isZero","normalise","lengthSquared","sqrt","distanceSquared","distance","angle","atan2","add","sub","mul","rotate","sin","cos","invert","dot","ao","ab","ac","pop","inverseDirection","intersection","combineSupport","update","EntityType","TILE_SIZE","tileColors","s","highV","lowV","hsvToRgb","dark","light","constructor","data","layers","type","tileLayers","objectLayers","getTileIndex","translateObjectPosition","willCollide","collisionSupport","bind","intersect","findCollision","dP","pos","radius","time","normal","draw","fillRect","beginPath","moveTo","lineTo","closePath","fill","levelFiles","levels","levelsLoaded","Promise","all","map","loadLevel","fetch","json","WorldMap","Level","MapObjectType","ObjectToEntityMap","Exit","Creature1","Goblin","Creature2","GoblinArcher","Creature3","Floater","Heart","Mcguffin","Spikes","GrenadePickup","objects","gid","Spawn","spawn","x","y","mcguffinCount","getEntities","Entity","WeaponType","entities","Set","player","level","paused","weaponsAvailable","Gun","debuffs","doubleDamage","fastMonsters","noHeal","slowRegen","undead","currentLevelId","Player","changeLevel","random","addBanner","addTopBanner","getLevel","clear","mcguffins","spritesheet","Image","spritesLoaded","onload","onerror","src","createElement","getCanvas","translate","arc","PI","stroke","strokeRect","then","drawImage","playerGraphic","makePlayerGraphic","fallbackGraphic","makeFallbackGraphic","goblinGraphic","makeGoblinGraphic","goblinArcherGraphic","heartGraphic","makeHeartGraphic","mcguffinGraphic","makeMcguffinGraphic","projectileGraphic","makeProjectileGraphic","exitGraphic","makeExitGraphic","spikesGraphic","makeSpikesGraphic","grenadeGraphic","makeGrenadeGraphic","gunIconGraphic","makeGunIconGraphic","bombIconGraphic","makeBombIconGraphic","floaterGraphic","makeFloaterGraphic","images","music","other","loaded","Map","pending","assetsLoaded","console","log","makeURL","error","oncanplay","arrayBuffer","catch","get","soundAssets","sounds","AudioContext","soundGainNode","createGain","musicGainNode","connect","destination","getAsset","decodeAudioData","musicVolume","gain","value","clamp","soundVolume","play","has","createBufferSource","buffer","start","connectMusic","createMediaElementSource","SoundManager","g","Faction","Facing","CollisionResponse","Right","Deflect","Foe","controlled","killable","maxHealth","graphic","speed","faction","Friend","ammoMax","ammo","health","harmful","damage","flying","floater","collisionResponse","Bounce","target","onhit","Grenade","die","pacer","TurnAround","ammoRegen","Projectile","facing","Left","v","Up","Down","limitedLife","lifespan","destroyOnUse","collectable","explosionTimer","explodes","Explosion","Neither","isExplosion","nextLevel","cooldown","sound","addDebuff","dV","weaponTimer","pow","ammoTimer","playerControl","weaponRange","shoot","onGround","collidable","updateMove","hit","weaponType","Space","A","D","includes","One","Two","Stop","delete","reset","lastFrameStart","pauseHeld","performance","now","P","togglePause","drawTopBanner","drawBanner","drawGUI","requestAnimationFrame","loop","healthGradient","createLinearGradient","addColorStop","loadingImage","setTimeout","init"],"mappings":"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"}